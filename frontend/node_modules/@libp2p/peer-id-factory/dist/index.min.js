(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PPeerIdFactory = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PPeerIdFactory=(()=>{var hf=Object.create;var Qr=Object.defineProperty;var lf=Object.getOwnPropertyDescriptor;var pf=Object.getOwnPropertyNames;var df=Object.getPrototypeOf,yf=Object.prototype.hasOwnProperty;var U=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),vt=(t,e)=>{for(var r in e)Qr(t,r,{get:e[r],enumerable:!0})},Ta=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of pf(e))!yf.call(t,i)&&i!==r&&Qr(t,i,{get:()=>e[i],enumerable:!(n=lf(e,i))||n.enumerable});return t};var Z=(t,e,r)=>(r=t!=null?hf(df(t)):{},Ta(e||!t||!t.__esModule?Qr(r,"default",{value:t,enumerable:!0}):r,t)),gf=t=>Ta(Qr({},"__esModule",{value:!0}),t);var _a=U((mp,Ia)=>{"use strict";Ia.exports=xf;function xf(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,a=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(o,c){r[n]=function(u){if(a)if(a=!1,u)c(u);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];o.apply(null,h)}};try{t.apply(e||null,r)}catch(f){a&&(a=!1,c(f))}})}});var Na=U(Da=>{"use strict";var Xr=Da;Xr.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var Ve=new Array(64),ka=new Array(123);for(Mt=0;Mt<64;)ka[Ve[Mt]=Mt<26?Mt+65:Mt<52?Mt+71:Mt<62?Mt-4:Mt-59|43]=Mt++;var Mt;Xr.encode=function(e,r,n){for(var i=null,a=[],s=0,o=0,c;r<n;){var f=e[r++];switch(o){case 0:a[s++]=Ve[f>>2],c=(f&3)<<4,o=1;break;case 1:a[s++]=Ve[c|f>>4],c=(f&15)<<2,o=2;break;case 2:a[s++]=Ve[c|f>>6],a[s++]=Ve[f&63],o=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,a)),s=0)}return o&&(a[s++]=Ve[c],a[s++]=61,o===1&&(a[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,a.slice(0,s))),i.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var Ra="invalid encoding";Xr.decode=function(e,r,n){for(var i=n,a=0,s,o=0;o<e.length;){var c=e.charCodeAt(o++);if(c===61&&a>1)break;if((c=ka[c])===void 0)throw Error(Ra);switch(a){case 0:s=c,a=1;break;case 1:r[n++]=s<<2|(c&48)>>4,s=c,a=2;break;case 2:r[n++]=(s&15)<<4|(c&60)>>2,s=c,a=3;break;case 3:r[n++]=(s&3)<<6|c,a=0;break}}if(a===1)throw Error(Ra);return n-i};Xr.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Pa=U((wp,La)=>{"use strict";La.exports=Jr;function Jr(){this._listeners={}}Jr.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};Jr.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};Jr.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var qa=U((Sp,Va)=>{"use strict";Va.exports=Ka(Ka);function Ka(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(c,f,u){e[0]=c,f[u]=r[0],f[u+1]=r[1],f[u+2]=r[2],f[u+3]=r[3]}function a(c,f,u){e[0]=c,f[u]=r[3],f[u+1]=r[2],f[u+2]=r[1],f[u+3]=r[0]}t.writeFloatLE=n?i:a,t.writeFloatBE=n?a:i;function s(c,f){return r[0]=c[f],r[1]=c[f+1],r[2]=c[f+2],r[3]=c[f+3],e[0]}function o(c,f){return r[3]=c[f],r[2]=c[f+1],r[1]=c[f+2],r[0]=c[f+3],e[0]}t.readFloatLE=n?s:o,t.readFloatBE=n?o:s}():function(){function e(n,i,a,s){var o=i<0?1:0;if(o&&(i=-i),i===0)n(1/i>0?0:2147483648,a,s);else if(isNaN(i))n(2143289344,a,s);else if(i>34028234663852886e22)n((o<<31|2139095040)>>>0,a,s);else if(i<11754943508222875e-54)n((o<<31|Math.round(i/1401298464324817e-60))>>>0,a,s);else{var c=Math.floor(Math.log(i)/Math.LN2),f=Math.round(i*Math.pow(2,-c)*8388608)&8388607;n((o<<31|c+127<<23|f)>>>0,a,s)}}t.writeFloatLE=e.bind(null,Ua),t.writeFloatBE=e.bind(null,Fa);function r(n,i,a){var s=n(i,a),o=(s>>31)*2+1,c=s>>>23&255,f=s&8388607;return c===255?f?NaN:o*(1/0):c===0?o*1401298464324817e-60*f:o*Math.pow(2,c-150)*(f+8388608)}t.readFloatLE=r.bind(null,Oa),t.readFloatBE=r.bind(null,Ma)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(c,f,u){e[0]=c,f[u]=r[0],f[u+1]=r[1],f[u+2]=r[2],f[u+3]=r[3],f[u+4]=r[4],f[u+5]=r[5],f[u+6]=r[6],f[u+7]=r[7]}function a(c,f,u){e[0]=c,f[u]=r[7],f[u+1]=r[6],f[u+2]=r[5],f[u+3]=r[4],f[u+4]=r[3],f[u+5]=r[2],f[u+6]=r[1],f[u+7]=r[0]}t.writeDoubleLE=n?i:a,t.writeDoubleBE=n?a:i;function s(c,f){return r[0]=c[f],r[1]=c[f+1],r[2]=c[f+2],r[3]=c[f+3],r[4]=c[f+4],r[5]=c[f+5],r[6]=c[f+6],r[7]=c[f+7],e[0]}function o(c,f){return r[7]=c[f],r[6]=c[f+1],r[5]=c[f+2],r[4]=c[f+3],r[3]=c[f+4],r[2]=c[f+5],r[1]=c[f+6],r[0]=c[f+7],e[0]}t.readDoubleLE=n?s:o,t.readDoubleBE=n?o:s}():function(){function e(n,i,a,s,o,c){var f=s<0?1:0;if(f&&(s=-s),s===0)n(0,o,c+i),n(1/s>0?0:2147483648,o,c+a);else if(isNaN(s))n(0,o,c+i),n(2146959360,o,c+a);else if(s>17976931348623157e292)n(0,o,c+i),n((f<<31|2146435072)>>>0,o,c+a);else{var u;if(s<22250738585072014e-324)u=s/5e-324,n(u>>>0,o,c+i),n((f<<31|u/4294967296)>>>0,o,c+a);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),u=s*Math.pow(2,-h),n(u*4503599627370496>>>0,o,c+i),n((f<<31|h+1023<<20|u*1048576&1048575)>>>0,o,c+a)}}}t.writeDoubleLE=e.bind(null,Ua,0,4),t.writeDoubleBE=e.bind(null,Fa,4,0);function r(n,i,a,s,o){var c=n(s,o+i),f=n(s,o+a),u=(f>>31)*2+1,h=f>>>20&2047,l=4294967296*(f&1048575)+c;return h===2047?l?NaN:u*(1/0):h===0?u*5e-324*l:u*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,Oa,0,4),t.readDoubleBE=r.bind(null,Ma,4,0)}(),t}function Ua(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function Fa(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function Oa(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function Ma(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var za=U((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var Ga=U(Ha=>{"use strict";var Vn=Ha;Vn.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};Vn.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var a=null,s=[],o=0,c;r<n;)c=e[r++],c<128?s[o++]=c:c>191&&c<224?s[o++]=(c&31)<<6|e[r++]&63:c>239&&c<365?(c=((c&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,s[o++]=55296+(c>>10),s[o++]=56320+(c&1023)):s[o++]=(c&15)<<12|(e[r++]&63)<<6|e[r++]&63,o>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,s)),o=0);return a?(o&&a.push(String.fromCharCode.apply(String,s.slice(0,o))),a.join("")):String.fromCharCode.apply(String,s.slice(0,o))};Vn.write=function(e,r,n){for(var i=n,a,s,o=0;o<e.length;++o)a=e.charCodeAt(o),a<128?r[n++]=a:a<2048?(r[n++]=a>>6|192,r[n++]=a&63|128):(a&64512)===55296&&((s=e.charCodeAt(o+1))&64512)===56320?(a=65536+((a&1023)<<10)+(s&1023),++o,r[n++]=a>>18|240,r[n++]=a>>12&63|128,r[n++]=a>>6&63|128,r[n++]=a&63|128):(r[n++]=a>>12|224,r[n++]=a>>6&63|128,r[n++]=a&63|128);return n-i}});var Za=U((Bp,Wa)=>{"use strict";Wa.exports=vf;function vf(t,e,r){var n=r||8192,i=n>>>1,a=null,s=n;return function(c){if(c<1||c>i)return t(c);s+c>n&&(a=t(n),s=0);var f=e.call(a,s,s+=c);return s&7&&(s=(s|7)+1),f}}});var $a=U((Ap,Ya)=>{"use strict";Ya.exports=lt;var br=Te();function lt(t,e){this.lo=t>>>0,this.hi=e>>>0}var Ce=lt.zero=new lt(0,0);Ce.toNumber=function(){return 0};Ce.zzEncode=Ce.zzDecode=function(){return this};Ce.length=function(){return 1};var mf=lt.zeroHash="\0\0\0\0\0\0\0\0";lt.fromNumber=function(e){if(e===0)return Ce;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new lt(n,i)};lt.from=function(e){if(typeof e=="number")return lt.fromNumber(e);if(br.isString(e))if(br.Long)e=br.Long.fromString(e);else return lt.fromNumber(parseInt(e,10));return e.low||e.high?new lt(e.low>>>0,e.high>>>0):Ce};lt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};lt.prototype.toLong=function(e){return br.Long?new br.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var le=String.prototype.charCodeAt;lt.fromHash=function(e){return e===mf?Ce:new lt((le.call(e,0)|le.call(e,1)<<8|le.call(e,2)<<16|le.call(e,3)<<24)>>>0,(le.call(e,4)|le.call(e,5)<<8|le.call(e,6)<<16|le.call(e,7)<<24)>>>0)};lt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};lt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};lt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};lt.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Te=U(qn=>{"use strict";var k=qn;k.asPromise=_a();k.base64=Na();k.EventEmitter=Pa();k.float=qa();k.inquire=za();k.utf8=Ga();k.pool=Za();k.LongBits=$a();k.isNode=Boolean(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);k.global=k.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||qn;k.emptyArray=Object.freeze?Object.freeze([]):[];k.emptyObject=Object.freeze?Object.freeze({}):{};k.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};k.isString=function(e){return typeof e=="string"||e instanceof String};k.isObject=function(e){return e&&typeof e=="object"};k.isset=k.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};k.Buffer=function(){try{var t=k.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();k._Buffer_from=null;k._Buffer_allocUnsafe=null;k.newBuffer=function(e){return typeof e=="number"?k.Buffer?k._Buffer_allocUnsafe(e):new k.Array(e):k.Buffer?k._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};k.Array=typeof Uint8Array<"u"?Uint8Array:Array;k.Long=k.global.dcodeIO&&k.global.dcodeIO.Long||k.global.Long||k.inquire("long");k.key2Re=/^true|false|0|1$/;k.key32Re=/^-?(?:0|[1-9][0-9]*)$/;k.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;k.longToHash=function(e){return e?k.LongBits.from(e).toHash():k.LongBits.zeroHash};k.longFromHash=function(e,r){var n=k.LongBits.fromHash(e);return k.Long?k.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function Qa(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}k.merge=Qa;k.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function Xa(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Qa(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}k.newError=Xa;k.ProtocolError=Xa("ProtocolError");k.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),a=i.length-1;a>-1;--a)if(r[i[a]]===1&&this[i[a]]!==void 0&&this[i[a]]!==null)return i[a]}};k.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};k.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};k._configure=function(){var t=k.Buffer;if(!t){k._Buffer_from=k._Buffer_allocUnsafe=null;return}k._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},k._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var Gn=U((Tp,rs)=>{"use strict";rs.exports=ct;var Wt=Te(),Hn,ts=Wt.LongBits,bf=Wt.utf8;function Vt(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function ct(t){this.buf=t,this.pos=0,this.len=t.length}var Ja=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new ct(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new ct(e);throw Error("illegal buffer")},es=function(){return Wt.Buffer?function(r){return(ct.create=function(i){return Wt.Buffer.isBuffer(i)?new Hn(i):Ja(i)})(r)}:Ja};ct.create=es();ct.prototype._slice=Wt.Array.prototype.subarray||Wt.Array.prototype.slice;ct.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Vt(this,10);return e}}();ct.prototype.int32=function(){return this.uint32()|0};ct.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function zn(){var t=new ts(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Vt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Vt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}ct.prototype.bool=function(){return this.uint32()!==0};function jr(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}ct.prototype.fixed32=function(){if(this.pos+4>this.len)throw Vt(this,4);return jr(this.buf,this.pos+=4)};ct.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Vt(this,4);return jr(this.buf,this.pos+=4)|0};function ja(){if(this.pos+8>this.len)throw Vt(this,8);return new ts(jr(this.buf,this.pos+=4),jr(this.buf,this.pos+=4))}ct.prototype.float=function(){if(this.pos+4>this.len)throw Vt(this,4);var e=Wt.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};ct.prototype.double=function(){if(this.pos+8>this.len)throw Vt(this,4);var e=Wt.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};ct.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw Vt(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};ct.prototype.string=function(){var e=this.bytes();return bf.read(e,0,e.length)};ct.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Vt(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Vt(this);while(this.buf[this.pos++]&128);return this};ct.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};ct._configure=function(t){Hn=t,ct.create=es(),Hn._configure();var e=Wt.Long?"toLong":"toNumber";Wt.merge(ct.prototype,{int64:function(){return zn.call(this)[e](!1)},uint64:function(){return zn.call(this)[e](!0)},sint64:function(){return zn.call(this).zzDecode()[e](!1)},fixed64:function(){return ja.call(this)[e](!0)},sfixed64:function(){return ja.call(this)[e](!1)}})}});var ss=U((Ip,as)=>{"use strict";as.exports=Ie;var is=Gn();(Ie.prototype=Object.create(is.prototype)).constructor=Ie;var ns=Te();function Ie(t){is.call(this,t)}Ie._configure=function(){ns.Buffer&&(Ie.prototype._slice=ns.Buffer.prototype.slice)};Ie.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Ie._configure()});var Jn=U((_p,us)=>{"use strict";us.exports=H;var Lt=Te(),Wn,tn=Lt.LongBits,os=Lt.base64,fs=Lt.utf8;function wr(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function Yn(){}function wf(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function H(){this.len=0,this.head=new wr(Yn,0,0),this.tail=this.head,this.states=null}var cs=function(){return Lt.Buffer?function(){return(H.create=function(){return new Wn})()}:function(){return new H}};H.create=cs();H.alloc=function(e){return new Lt.Array(e)};Lt.Array!==Array&&(H.alloc=Lt.pool(H.alloc,Lt.Array.prototype.subarray));H.prototype._push=function(e,r,n){return this.tail=this.tail.next=new wr(e,r,n),this.len+=r,this};function $n(t,e,r){e[r]=t&255}function Sf(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Qn(t,e){this.len=t,this.next=void 0,this.val=e}Qn.prototype=Object.create(wr.prototype);Qn.prototype.fn=Sf;H.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Qn((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};H.prototype.int32=function(e){return e<0?this._push(Xn,10,tn.fromNumber(e)):this.uint32(e)};H.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Xn(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}H.prototype.uint64=function(e){var r=tn.from(e);return this._push(Xn,r.length(),r)};H.prototype.int64=H.prototype.uint64;H.prototype.sint64=function(e){var r=tn.from(e).zzEncode();return this._push(Xn,r.length(),r)};H.prototype.bool=function(e){return this._push($n,1,e?1:0)};function Zn(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}H.prototype.fixed32=function(e){return this._push(Zn,4,e>>>0)};H.prototype.sfixed32=H.prototype.fixed32;H.prototype.fixed64=function(e){var r=tn.from(e);return this._push(Zn,4,r.lo)._push(Zn,4,r.hi)};H.prototype.sfixed64=H.prototype.fixed64;H.prototype.float=function(e){return this._push(Lt.float.writeFloatLE,4,e)};H.prototype.double=function(e){return this._push(Lt.float.writeDoubleLE,8,e)};var Ef=Lt.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};H.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push($n,1,0);if(Lt.isString(e)){var n=H.alloc(r=os.length(e));os.decode(e,n,0),e=n}return this.uint32(r)._push(Ef,r,e)};H.prototype.string=function(e){var r=fs.length(e);return r?this.uint32(r)._push(fs.write,r,e):this._push($n,1,0)};H.prototype.fork=function(){return this.states=new wf(this),this.head=this.tail=new wr(Yn,0,0),this.len=0,this};H.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new wr(Yn,0,0),this.len=0),this};H.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};H.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};H._configure=function(t){Wn=t,H.create=cs(),Wn._configure()}});var ps=U((Rp,ls)=>{"use strict";ls.exports=Zt;var hs=Jn();(Zt.prototype=Object.create(hs.prototype)).constructor=Zt;var pe=Te();function Zt(){hs.call(this)}Zt._configure=function(){Zt.alloc=pe._Buffer_allocUnsafe,Zt.writeBytesBuffer=pe.Buffer&&pe.Buffer.prototype instanceof Uint8Array&&pe.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};Zt.prototype.bytes=function(e){pe.isString(e)&&(e=pe._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(Zt.writeBytesBuffer,r,e),this};function Bf(t,e,r){t.length<40?pe.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}Zt.prototype.string=function(e){var r=pe.Buffer.byteLength(e);return this.uint32(r),r&&this._push(Bf,r,e),this};Zt._configure()});var X=U((Yp,vs)=>{vs.exports={options:{usePureJavaScript:!1}}});var ws=U(($p,bs)=>{var ai={};bs.exports=ai;var ms={};ai.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=If(t,e);else{var i=0,a=e.length,s=e.charAt(0),o=[0];for(i=0;i<t.length;++i){for(var c=0,f=t[i];c<o.length;++c)f+=o[c]<<8,o[c]=f%a,f=f/a|0;for(;f>0;)o.push(f%a),f=f/a|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=s;for(i=o.length-1;i>=0;--i)n+=e[o[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};ai.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=ms[e];if(!r){r=ms[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,a=e.charAt(0),s=[0],n=0;n<t.length;n++){var o=r[t.charCodeAt(n)];if(o===void 0)return;for(var c=0,f=o;c<s.length;++c)f+=s[c]*i,s[c]=f&255,f>>=8;for(;f>0;)s.push(f&255),f>>=8}for(var u=0;t[u]===a&&u<t.length-1;++u)s.push(0);return typeof Buffer<"u"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function If(t,e){var r=0,n=e.length,i=e.charAt(0),a=[0];for(r=0;r<t.length();++r){for(var s=0,o=t.at(r);s<a.length;++s)o+=a[s]<<8,a[s]=o%n,o=o/n|0;for(;o>0;)a.push(o%n),o=o/n|0}var c="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)c+=i;for(r=a.length-1;r>=0;--r)c+=e[a[r]];return c}});var ht=U((Qp,As)=>{var Ss=X(),Es=ws(),y=As.exports=Ss.util=Ss.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){y.nextTick=process.nextTick,typeof setImmediate=="function"?y.setImmediate=setImmediate:y.setImmediate=y.nextTick;return}if(typeof setImmediate=="function"){y.setImmediate=function(){return setImmediate.apply(void 0,arguments)},y.nextTick=function(o){return setImmediate(o)};return}if(y.setImmediate=function(o){setTimeout(o,0)},typeof window<"u"&&typeof window.postMessage=="function"){let o=function(c){if(c.source===window&&c.data===t){c.stopPropagation();var f=e.slice();e.length=0,f.forEach(function(u){u()})}};var s=o,t="forge.setImmediate",e=[];y.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(f){f()})}).observe(i,{attributes:!0});var a=y.setImmediate;y.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),a(c)):(e.push(c),e.length===1&&i.setAttribute("a",n=!n))}}y.nextTick=y.setImmediate})();y.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;y.globalScope=function(){return y.isNodejs?globalThis:typeof self>"u"?window:self}();y.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};y.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};y.isArrayBufferView=function(t){return t&&y.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function Sr(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}y.ByteBuffer=si;function si(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(y.isArrayBuffer(t)||y.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof si||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}y.ByteStringBuffer=si;var _f=4096;y.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>_f&&(this.data.substr(0,1),this._constructedStringLength=0)};y.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};y.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};y.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};y.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};y.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};y.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(y.encodeUtf8(t))};y.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};y.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};y.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};y.ByteStringBuffer.prototype.putInt=function(t,e){Sr(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};y.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};y.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};y.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};y.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};y.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};y.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};y.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};y.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};y.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};y.ByteStringBuffer.prototype.getInt=function(t){Sr(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};y.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};y.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};y.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};y.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};y.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};y.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};y.ByteStringBuffer.prototype.copy=function(){var t=y.createBuffer(this.data);return t.read=this.read,t};y.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};y.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};y.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};y.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};y.ByteStringBuffer.prototype.toString=function(){return y.decodeUtf8(this.bytes())};function Rf(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=y.isArrayBuffer(t),n=y.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}y.DataBuffer=Rf;y.DataBuffer.prototype.length=function(){return this.write-this.read};y.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};y.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};y.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};y.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};y.DataBuffer.prototype.putBytes=function(t,e){if(y.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(y.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof y.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&y.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof y.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var a;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),a=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.hex.decode(t,a,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),a=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.base64.decode(t,a,this.write),this;if(e==="utf8"&&(t=y.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),a=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.raw.decode(a),this;if(e==="utf16")return this.accommodate(t.length*2),a=new Uint16Array(this.data.buffer,this.write),this.write+=y.text.utf16.encode(a),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};y.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};y.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};y.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};y.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};y.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};y.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};y.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};y.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};y.DataBuffer.prototype.putInt=function(t,e){Sr(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};y.DataBuffer.prototype.putSignedInt=function(t,e){return Sr(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};y.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};y.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};y.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};y.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};y.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};y.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};y.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};y.DataBuffer.prototype.getInt=function(t){Sr(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};y.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};y.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};y.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};y.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};y.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};y.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};y.DataBuffer.prototype.copy=function(){return new y.DataBuffer(this)};y.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};y.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};y.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};y.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};y.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return y.binary.raw.encode(e);if(t==="hex")return y.binary.hex.encode(e);if(t==="base64")return y.binary.base64.encode(e);if(t==="utf8")return y.text.utf8.decode(e);if(t==="utf16")return y.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};y.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=y.encodeUtf8(t)),new y.ByteBuffer(t)};y.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};y.xorBytes=function(t,e,r){for(var n="",i="",a="",s=0,o=0;r>0;--r,++s)i=t.charCodeAt(s)^e.charCodeAt(s),o>=10&&(n+=a,a="",o=0),a+=String.fromCharCode(i),++o;return n+=a,n};y.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};y.bytesToHex=function(t){return y.createBuffer(t).toHex()};y.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var de="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ye=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Bs="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";y.encode64=function(t,e){for(var r="",n="",i,a,s,o=0;o<t.length;)i=t.charCodeAt(o++),a=t.charCodeAt(o++),s=t.charCodeAt(o++),r+=de.charAt(i>>2),r+=de.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=de.charAt((a&15)<<2|s>>6),r+=isNaN(s)?"=":de.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};y.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,a,s=0;s<t.length;)r=ye[t.charCodeAt(s++)-43],n=ye[t.charCodeAt(s++)-43],i=ye[t.charCodeAt(s++)-43],a=ye[t.charCodeAt(s++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),a!==64&&(e+=String.fromCharCode((i&3)<<6|a)));return e};y.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};y.decodeUtf8=function(t){return decodeURIComponent(escape(t))};y.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Es.encode,decode:Es.decode}};y.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};y.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,a=0;a<t.length;++a)n[i++]=t.charCodeAt(a);return e?i-r:n};y.binary.hex.encode=y.bytesToHex;y.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,a=r;for(t.length&1&&(i=1,n[a++]=parseInt(t[0],16));i<t.length;i+=2)n[a++]=parseInt(t.substr(i,2),16);return e?a-r:n};y.binary.base64.encode=function(t,e){for(var r="",n="",i,a,s,o=0;o<t.byteLength;)i=t[o++],a=t[o++],s=t[o++],r+=de.charAt(i>>2),r+=de.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=de.charAt((a&15)<<2|s>>6),r+=isNaN(s)?"=":de.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};y.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,a,s,o,c=0,f=r;c<t.length;)i=ye[t.charCodeAt(c++)-43],a=ye[t.charCodeAt(c++)-43],s=ye[t.charCodeAt(c++)-43],o=ye[t.charCodeAt(c++)-43],n[f++]=i<<2|a>>4,s!==64&&(n[f++]=(a&15)<<4|s>>2,o!==64&&(n[f++]=(s&3)<<6|o));return e?f-r:n.subarray(0,f)};y.binary.base58.encode=function(t,e){return y.binary.baseN.encode(t,Bs,e)};y.binary.base58.decode=function(t,e){return y.binary.baseN.decode(t,Bs,e)};y.text={utf8:{},utf16:{}};y.text.utf8.encode=function(t,e,r){t=y.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,a=0;a<t.length;++a)n[i++]=t.charCodeAt(a);return e?i-r:n};y.text.utf8.decode=function(t){return y.decodeUtf8(String.fromCharCode.apply(null,t))};y.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var a=r,s=r,o=0;o<t.length;++o)i[s++]=t.charCodeAt(o),a+=2;return e?a-r:n};y.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};y.deflate=function(t,e,r){if(e=y.decode64(t.deflate(y.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};y.inflate=function(t,e,r){var n=t.inflate(y.encode64(e)).rval;return n===null?null:y.decode64(n)};var oi=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=y.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},fi=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(y.decode64(r))),r},kf=function(t,e,r,n){var i=fi(t,e);i===null&&(i={}),i[r]=n,oi(t,e,i)},Df=function(t,e,r){var n=fi(t,e);return n!==null&&(n=r in n?n[r]:null),n},Nf=function(t,e,r){var n=fi(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var a in n){i=!1;break}i&&(n=null),oi(t,e,n)}},Lf=function(t,e){oi(t,e,null)},nn=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,a=!1,s=null;for(var o in r){i=r[o];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),a=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),a=!0)}catch(c){s=c}if(a)break}if(!a)throw s;return n};y.setItem=function(t,e,r,n,i){nn(kf,arguments,i)};y.getItem=function(t,e,r,n){return nn(Df,arguments,n)};y.removeItem=function(t,e,r,n){nn(Nf,arguments,n)};y.clearItems=function(t,e,r){nn(Lf,arguments,r)};y.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};y.format=function(t){for(var e=/%./g,r,n,i=0,a=[],s=0;r=e.exec(t);){n=t.substring(s,e.lastIndex-2),n.length>0&&a.push(n),s=e.lastIndex;var o=r[0][1];switch(o){case"s":case"o":i<arguments.length?a.push(arguments[i+++1]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+o+"?>")}}return a.push(t.substring(s)),a.join("")};y.formatNumber=function(t,e,r,n){var i=t,a=isNaN(e=Math.abs(e))?2:e,s=r===void 0?",":r,o=n===void 0?".":n,c=i<0?"-":"",f=parseInt(i=Math.abs(+i||0).toFixed(a),10)+"",u=f.length>3?f.length%3:0;return c+(u?f.substr(0,u)+o:"")+f.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+o)+(a?s+Math.abs(i-f).toFixed(a).slice(2):"")};y.formatSize=function(t){return t>=1073741824?t=y.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=y.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=y.formatNumber(t/1024,0)+" KiB":t=y.formatNumber(t,0)+" bytes",t};y.bytesFromIP=function(t){return t.indexOf(".")!==-1?y.bytesFromIPv4(t):t.indexOf(":")!==-1?y.bytesFromIPv6(t):null};y.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=y.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};y.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(s){return s.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=y.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var a=y.hexToBytes(t[i]);a.length<2&&n.putByte(0),n.putBytes(a)}return n.getBytes()};y.bytesToIP=function(t){return t.length===4?y.bytesToIPv4(t):t.length===16?y.bytesToIPv6(t):null};y.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};y.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var a=y.bytesToHex(t[i]+t[i+1]);a[0]==="0"&&a!=="0";)a=a.substr(1);if(a==="0"){var s=r[r.length-1],o=e.length;!s||o!==s.end+1?r.push({start:o,end:o}):(s.end=o,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(a)}if(r.length>0){var c=r[n];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};y.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in y&&!t.update)return e(null,y.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return y.cores=navigator.hardwareConcurrency,e(null,y.cores);if(typeof Worker>"u")return y.cores=1,e(null,y.cores);if(typeof Blob>"u")return y.cores=2,e(null,y.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var o=Date.now(),c=o+4;Date.now()<c;);self.postMessage({st:o,et:c})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(s,o,c){if(o===0){var f=Math.floor(s.reduce(function(u,h){return u+h},0)/s.length);return y.cores=Math.max(1,f),URL.revokeObjectURL(r),e(null,y.cores)}i(c,function(u,h){s.push(a(c,h)),n(s,o-1,c)})}function i(s,o){for(var c=[],f=[],u=0;u<s;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(f.push(l.data),f.length===s){for(var d=0;d<s;++d)c[d].terminate();o(null,f)}}),c.push(h)}for(var u=0;u<s;++u)c[u].postMessage(u)}function a(s,o){for(var c=[],f=0;f<s;++f)for(var u=o[f],h=c[f]=[],l=0;l<s;++l)if(f!==l){var d=o[l];(u.st>d.st&&u.st<d.et||d.st>u.st&&d.st<u.et)&&h.push(l)}return c.reduce(function(p,g){return Math.max(p,g.length)},0)}}});var an=U((Xp,Cs)=>{var Er=X();Er.pki=Er.pki||{};var ci=Cs.exports=Er.pki.oids=Er.oids=Er.oids||{};function E(t,e){ci[t]=e,ci[e]=t}function $(t,e){ci[t]=e}E("1.2.840.113549.1.1.1","rsaEncryption");E("1.2.840.113549.1.1.4","md5WithRSAEncryption");E("1.2.840.113549.1.1.5","sha1WithRSAEncryption");E("1.2.840.113549.1.1.7","RSAES-OAEP");E("1.2.840.113549.1.1.8","mgf1");E("1.2.840.113549.1.1.9","pSpecified");E("1.2.840.113549.1.1.10","RSASSA-PSS");E("1.2.840.113549.1.1.11","sha256WithRSAEncryption");E("1.2.840.113549.1.1.12","sha384WithRSAEncryption");E("1.2.840.113549.1.1.13","sha512WithRSAEncryption");E("1.3.101.112","EdDSA25519");E("1.2.840.10040.4.3","dsa-with-sha1");E("1.3.14.3.2.7","desCBC");E("1.3.14.3.2.26","sha1");E("1.3.14.3.2.29","sha1WithRSASignature");E("2.16.840.1.101.3.4.2.1","sha256");E("2.16.840.1.101.3.4.2.2","sha384");E("2.16.840.1.101.3.4.2.3","sha512");E("2.16.840.1.101.3.4.2.4","sha224");E("2.16.840.1.101.3.4.2.5","sha512-224");E("2.16.840.1.101.3.4.2.6","sha512-256");E("1.2.840.113549.2.2","md2");E("1.2.840.113549.2.5","md5");E("1.2.840.113549.1.7.1","data");E("1.2.840.113549.1.7.2","signedData");E("1.2.840.113549.1.7.3","envelopedData");E("1.2.840.113549.1.7.4","signedAndEnvelopedData");E("1.2.840.113549.1.7.5","digestedData");E("1.2.840.113549.1.7.6","encryptedData");E("1.2.840.113549.1.9.1","emailAddress");E("1.2.840.113549.1.9.2","unstructuredName");E("1.2.840.113549.1.9.3","contentType");E("1.2.840.113549.1.9.4","messageDigest");E("1.2.840.113549.1.9.5","signingTime");E("1.2.840.113549.1.9.6","counterSignature");E("1.2.840.113549.1.9.7","challengePassword");E("1.2.840.113549.1.9.8","unstructuredAddress");E("1.2.840.113549.1.9.14","extensionRequest");E("1.2.840.113549.1.9.20","friendlyName");E("1.2.840.113549.1.9.21","localKeyId");E("1.2.840.113549.1.9.22.1","x509Certificate");E("1.2.840.113549.1.12.10.1.1","keyBag");E("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");E("1.2.840.113549.1.12.10.1.3","certBag");E("1.2.840.113549.1.12.10.1.4","crlBag");E("1.2.840.113549.1.12.10.1.5","secretBag");E("1.2.840.113549.1.12.10.1.6","safeContentsBag");E("1.2.840.113549.1.5.13","pkcs5PBES2");E("1.2.840.113549.1.5.12","pkcs5PBKDF2");E("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");E("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");E("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");E("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");E("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");E("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");E("1.2.840.113549.2.7","hmacWithSHA1");E("1.2.840.113549.2.8","hmacWithSHA224");E("1.2.840.113549.2.9","hmacWithSHA256");E("1.2.840.113549.2.10","hmacWithSHA384");E("1.2.840.113549.2.11","hmacWithSHA512");E("1.2.840.113549.3.7","des-EDE3-CBC");E("2.16.840.1.101.3.4.1.2","aes128-CBC");E("2.16.840.1.101.3.4.1.22","aes192-CBC");E("2.16.840.1.101.3.4.1.42","aes256-CBC");E("2.5.4.3","commonName");E("2.5.4.4","surname");E("2.5.4.5","serialNumber");E("2.5.4.6","countryName");E("2.5.4.7","localityName");E("2.5.4.8","stateOrProvinceName");E("2.5.4.9","streetAddress");E("2.5.4.10","organizationName");E("2.5.4.11","organizationalUnitName");E("2.5.4.12","title");E("2.5.4.13","description");E("2.5.4.15","businessCategory");E("2.5.4.17","postalCode");E("2.5.4.42","givenName");E("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");E("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");E("2.16.840.1.113730.1.1","nsCertType");E("2.16.840.1.113730.1.13","nsComment");$("2.5.29.1","authorityKeyIdentifier");$("2.5.29.2","keyAttributes");$("2.5.29.3","certificatePolicies");$("2.5.29.4","keyUsageRestriction");$("2.5.29.5","policyMapping");$("2.5.29.6","subtreesConstraint");$("2.5.29.7","subjectAltName");$("2.5.29.8","issuerAltName");$("2.5.29.9","subjectDirectoryAttributes");$("2.5.29.10","basicConstraints");$("2.5.29.11","nameConstraints");$("2.5.29.12","policyConstraints");$("2.5.29.13","basicConstraints");E("2.5.29.14","subjectKeyIdentifier");E("2.5.29.15","keyUsage");$("2.5.29.16","privateKeyUsagePeriod");E("2.5.29.17","subjectAltName");E("2.5.29.18","issuerAltName");E("2.5.29.19","basicConstraints");$("2.5.29.20","cRLNumber");$("2.5.29.21","cRLReason");$("2.5.29.22","expirationDate");$("2.5.29.23","instructionCode");$("2.5.29.24","invalidityDate");$("2.5.29.25","cRLDistributionPoints");$("2.5.29.26","issuingDistributionPoint");$("2.5.29.27","deltaCRLIndicator");$("2.5.29.28","issuingDistributionPoint");$("2.5.29.29","certificateIssuer");$("2.5.29.30","nameConstraints");E("2.5.29.31","cRLDistributionPoints");E("2.5.29.32","certificatePolicies");$("2.5.29.33","policyMappings");$("2.5.29.34","policyConstraints");E("2.5.29.35","authorityKeyIdentifier");$("2.5.29.36","policyConstraints");E("2.5.29.37","extKeyUsage");$("2.5.29.46","freshestCRL");$("2.5.29.54","inhibitAnyPolicy");E("1.3.6.1.4.1.11129.2.4.2","timestampList");E("1.3.6.1.5.5.7.1.1","authorityInfoAccess");E("1.3.6.1.5.5.7.3.1","serverAuth");E("1.3.6.1.5.5.7.3.2","clientAuth");E("1.3.6.1.5.5.7.3.3","codeSigning");E("1.3.6.1.5.5.7.3.4","emailProtection");E("1.3.6.1.5.5.7.3.8","timeStamping")});var Ar=U((Jp,Is)=>{var j=X();ht();an();var C=Is.exports=j.asn1=j.asn1||{};C.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};C.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};C.create=function(t,e,r,n,i){if(j.util.isArray(n)){for(var a=[],s=0;s<n.length;++s)n[s]!==void 0&&a.push(n[s]);n=a}var o={tagClass:t,type:e,constructed:r,composed:r||j.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(o.bitStringContents=i.bitStringContents,o.original=C.copy(o)),o};C.copy=function(t,e){var r;if(j.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(C.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:C.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};C.equals=function(t,e,r){if(j.util.isArray(t)){if(!j.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!C.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&C.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};C.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Br(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var Pf=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var a=r&127;Br(t,e,a),n=t.getInt(a<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};C.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=j.util.createBuffer(t));var r=t.length(),n=sn(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function sn(t,e,r,n){var i;Br(t,e,2);var a=t.getByte();e--;var s=a&192,o=a&31;i=t.length();var c=Pf(t,e);if(e-=i-t.length(),c!==void 0&&c>e){if(n.strict){var f=new Error("Too few bytes to read ASN.1 value.");throw f.available=t.length(),f.remaining=e,f.requested=c,f}c=e}var u,h,l=(a&32)===32;if(l)if(u=[],c===void 0)for(;;){if(Br(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),u.push(sn(t,e,r+1,n)),e-=i-t.length()}else for(;c>0;)i=t.length(),u.push(sn(t,c,r+1,n)),e-=i-t.length(),c-=i-t.length();if(u===void 0&&s===C.Class.UNIVERSAL&&o===C.Type.BITSTRING&&(h=t.bytes(c)),u===void 0&&n.decodeBitStrings&&s===C.Class.UNIVERSAL&&o===C.Type.BITSTRING&&c>1){var d=t.read,p=e,g=0;if(o===C.Type.BITSTRING&&(Br(t,e,1),g=t.getByte(),e--),g===0)try{i=t.length();var v={strict:!0,decodeBitStrings:!0},b=sn(t,e,r+1,v),B=i-t.length();e-=B,o==C.Type.BITSTRING&&B++;var A=b.tagClass;B===c&&(A===C.Class.UNIVERSAL||A===C.Class.CONTEXT_SPECIFIC)&&(u=[b])}catch{}u===void 0&&(t.read=d,e=p)}if(u===void 0){if(c===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(o===C.Type.BMPSTRING)for(u="";c>0;c-=2)Br(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(c),e-=c}var N=h===void 0?null:{bitStringContents:h};return C.create(s,o,l,u,N)}C.toDer=function(t){var e=j.util.createBuffer(),r=t.tagClass|t.type,n=j.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=C.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var a=0;a<t.value.length;++a)t.value[a]!==void 0&&n.putBuffer(C.toDer(t.value[a]))}else if(t.type===C.Type.BMPSTRING)for(var a=0;a<t.value.length;++a)n.putInt16(t.value.charCodeAt(a));else t.type===C.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var s=n.length(),o="";do o+=String.fromCharCode(s&255),s=s>>>8;while(s>0);e.putByte(o.length|128);for(var a=o.length-1;a>=0;--a)e.putByte(o.charCodeAt(a))}return e.putBuffer(n),e};C.oidToDer=function(t){var e=t.split("."),r=j.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,a,s,o=2;o<e.length;++o){n=!0,i=[],a=parseInt(e[o],10);do s=a&127,a=a>>>7,n||(s|=128),i.push(s),n=!1;while(a>0);for(var c=i.length-1;c>=0;--c)r.putByte(i[c])}return r};C.derToOid=function(t){var e;typeof t=="string"&&(t=j.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};C.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),a=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=0;if(t.length>11){var c=t.charAt(10),f=10;c!=="+"&&c!=="-"&&(o=parseInt(t.substr(10,2),10),f+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(a,s,o,0),f&&(c=t.charAt(f),c==="+"||c==="-")){var u=parseInt(t.substr(f+1,2),10),h=parseInt(t.substr(f+4,2),10),l=u*60+h;l*=6e4,c==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};C.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),s=parseInt(t.substr(10,2),10),o=parseInt(t.substr(12,2),10),c=0,f=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var d=parseInt(t.substr(h+1,2),10),p=parseInt(t.substr(h+4,2),10);f=d*60+p,f*=6e4,l==="+"&&(f*=-1),u=!0}return t.charAt(14)==="."&&(c=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(a,s,o,c),e.setTime(+e+f)):(e.setFullYear(r,n,i),e.setHours(a,s,o,c)),e};C.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};C.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};C.integerToDer=function(t){var e=j.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};C.derToInteger=function(t){typeof t=="string"&&(t=j.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};C.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&j.util.isArray(e.value))for(var a=0,s=0;i&&s<e.value.length;++s)i=e.value[s].optional||!1,t.value[a]&&(i=C.validate(t.value[a],e.value[s],r,n),i?++a:e.value[s].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var o;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var c=t.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var Ts=/[^\\u0000-\\u00ff]/;C.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",a=0;a<e*r;++a)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case C.Class.UNIVERSAL:n+="Universal:";break;case C.Class.APPLICATION:n+="Application:";break;case C.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case C.Class.PRIVATE:n+="Private:";break}if(t.tagClass===C.Class.UNIVERSAL)switch(n+=t.type,t.type){case C.Type.NONE:n+=" (None)";break;case C.Type.BOOLEAN:n+=" (Boolean)";break;case C.Type.INTEGER:n+=" (Integer)";break;case C.Type.BITSTRING:n+=" (Bit string)";break;case C.Type.OCTETSTRING:n+=" (Octet string)";break;case C.Type.NULL:n+=" (Null)";break;case C.Type.OID:n+=" (Object Identifier)";break;case C.Type.ODESC:n+=" (Object Descriptor)";break;case C.Type.EXTERNAL:n+=" (External or Instance of)";break;case C.Type.REAL:n+=" (Real)";break;case C.Type.ENUMERATED:n+=" (Enumerated)";break;case C.Type.EMBEDDED:n+=" (Embedded PDV)";break;case C.Type.UTF8:n+=" (UTF8)";break;case C.Type.ROID:n+=" (Relative Object Identifier)";break;case C.Type.SEQUENCE:n+=" (Sequence)";break;case C.Type.SET:n+=" (Set)";break;case C.Type.PRINTABLESTRING:n+=" (Printable String)";break;case C.Type.IA5String:n+=" (IA5String (ASCII))";break;case C.Type.UTCTIME:n+=" (UTC time)";break;case C.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case C.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var s=0,o="",a=0;a<t.value.length;++a)t.value[a]!==void 0&&(s+=1,o+=C.prettyPrint(t.value[a],e+1,r),a+1<t.value.length&&(o+=","));n+=i+"Sub values: "+s+o}else{if(n+=i+"Value: ",t.type===C.Type.OID){var c=C.derToOid(t.value);n+=c,j.pki&&j.pki.oids&&c in j.pki.oids&&(n+=" ("+j.pki.oids[c]+") ")}if(t.type===C.Type.INTEGER)try{n+=C.derToInteger(t.value)}catch{n+="0x"+j.util.bytesToHex(t.value)}else if(t.type===C.Type.BITSTRING){if(t.value.length>1?n+="0x"+j.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var f=t.value.charCodeAt(0);f==1?n+=" (1 unused bit shown)":f>1&&(n+=" ("+f+" unused bits shown)")}}else if(t.type===C.Type.OCTETSTRING)Ts.test(t.value)||(n+="("+t.value+") "),n+="0x"+j.util.bytesToHex(t.value);else if(t.type===C.Type.UTF8)try{n+=j.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+j.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===C.Type.PRINTABLESTRING||t.type===C.Type.IA5String?n+=t.value:Ts.test(t.value)?n+="0x"+j.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var hi=U((jp,_s)=>{var pt=X();ht();_s.exports=pt.cipher=pt.cipher||{};pt.cipher.algorithms=pt.cipher.algorithms||{};pt.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=pt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new pt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};pt.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=pt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new pt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};pt.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),pt.cipher.algorithms[t]=e};pt.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in pt.cipher.algorithms?pt.cipher.algorithms[t]:null};var ui=pt.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};ui.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=pt.util.createBuffer(),this.output=t.output||pt.util.createBuffer(),this.mode.start(e)};ui.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};ui.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var pi=U((td,Rs)=>{var dt=X();ht();dt.cipher=dt.cipher||{};var F=Rs.exports=dt.cipher.modes=dt.cipher.modes||{};F.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};F.ecb.prototype.start=function(t){};F.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};F.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};F.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};F.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};F.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};F.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=on(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};F.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};F.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};F.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};F.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};F.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=dt.util.createBuffer(),this._partialBytes=0};F.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=on(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};F.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};F.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};F.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=dt.util.createBuffer(),this._partialBytes=0};F.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=on(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};F.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};F.ofb.prototype.decrypt=F.ofb.prototype.encrypt;F.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=dt.util.createBuffer(),this._partialBytes=0};F.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=on(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};F.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}fn(this._inBlock)};F.ctr.prototype.decrypt=F.ctr.prototype.encrypt;F.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=dt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};F.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=dt.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=dt.util.createBuffer(t.additionalData):r=dt.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=dt.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(li(n*8)))}this._inBlock=this._j0.slice(0),fn(this._inBlock),this._partialBytes=0,r=dt.util.createBuffer(r),this._aDataLength=li(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};F.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),fn(this._inBlock)};F.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),fn(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};F.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=dt.util.createBuffer();var n=this._aDataLength.concat(li(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var a=0;a<this._ints;++a)this.tag.putInt32(this._s[a]^i[a]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};F.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var a=t[i/32|0]&1<<31-i%32;a&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};F.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};F.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,a=this._m[r][i];e[0]^=a[0],e[1]^=a[1],e[2]^=a[2],e[3]^=a[3]}return e};F.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};F.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,a=new Array(i),s=0;s<i;++s){var o=[0,0,0,0],c=s/n|0,f=(n-1-s%n)*e;o[c]=1<<e-1<<f,a[s]=this.generateSubHashTable(this.multiply(o,t),e)}return a};F.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var a=n>>>1;a>0;)this.pow(i[2*a],i[a]=[]),a>>=1;for(a=2;a<n;){for(var s=1;s<a;++s){var o=i[a],c=i[s];i[a+s]=[o[0]^c[0],o[1]^c[1],o[2]^c[2],o[3]^c[3]]}a*=2}for(i[0]=[0,0,0,0],a=n+1;a<r;++a){var f=i[a^n];i[a]=[t[0]^f[0],t[1]^f[1],t[2]^f[2],t[3]^f[3]]}return i};function on(t,e){if(typeof t=="string"&&(t=dt.util.createBuffer(t)),dt.util.isArray(t)&&t.length>4){var r=t;t=dt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!dt.util.isArray(t)){for(var i=[],a=e/4,n=0;n<a;++n)i.push(t.getInt32());t=i}return t}function fn(t){t[t.length-1]=t[t.length-1]+1&4294967295}function li(t){return[t/4294967296|0,t&4294967295]}});var xi=U((ed,Ls)=>{var J=X();hi();pi();ht();Ls.exports=J.aes=J.aes||{};J.aes.startEncrypting=function(t,e,r,n){var i=cn({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};J.aes.createEncryptionCipher=function(t,e){return cn({key:t,output:null,decrypt:!1,mode:e})};J.aes.startDecrypting=function(t,e,r,n){var i=cn({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};J.aes.createDecryptionCipher=function(t,e){return cn({key:t,output:null,decrypt:!0,mode:e})};J.aes.Algorithm=function(t,e){gi||Ds();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return yi(r._w,n,i,!1)},decrypt:function(n,i){return yi(r._w,n,i,!0)}}}),r._init=!1};J.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=J.util.createBuffer(e);else if(J.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=J.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!J.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!J.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var a=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(a)!==-1;this._w=Ns(e,t.decrypt&&!s),this._init=!0}};J.aes._expandKey=function(t,e){return gi||Ds(),Ns(t,e)};J.aes._updateBlock=yi;Ze("AES-ECB",J.cipher.modes.ecb);Ze("AES-CBC",J.cipher.modes.cbc);Ze("AES-CFB",J.cipher.modes.cfb);Ze("AES-OFB",J.cipher.modes.ofb);Ze("AES-CTR",J.cipher.modes.ctr);Ze("AES-GCM",J.cipher.modes.gcm);function Ze(t,e){var r=function(){return new J.aes.Algorithm(t,e)};J.cipher.registerAlgorithm(t,r)}var gi=!1,We=4,St,di,ks,_e,qt;function Ds(){gi=!0,ks=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;St=new Array(256),di=new Array(256),_e=new Array(4),qt=new Array(4);for(var e=0;e<4;++e)_e[e]=new Array(256),qt[e]=new Array(256);for(var r=0,n=0,i,a,s,o,c,f,u,e=0;e<256;++e){o=n^n<<1^n<<2^n<<3^n<<4,o=o>>8^o&255^99,St[r]=o,di[o]=r,c=t[o],i=t[r],a=t[i],s=t[a],f=c<<24^o<<16^o<<8^(o^c),u=(i^a^s)<<24^(r^s)<<16^(r^a^s)<<8^(r^i^s);for(var h=0;h<4;++h)_e[h][r]=f,qt[h][o]=u,f=f<<24|f>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^s]]],n^=t[t[n]])}}function Ns(t,e){for(var r=t.slice(0),n,i=1,a=r.length,s=a+6+1,o=We*s,c=a;c<o;++c)n=r[c-1],c%a===0?(n=St[n>>>16&255]<<24^St[n>>>8&255]<<16^St[n&255]<<8^St[n>>>24]^ks[i]<<24,i++):a>6&&c%a===4&&(n=St[n>>>24]<<24^St[n>>>16&255]<<16^St[n>>>8&255]<<8^St[n&255]),r[c]=r[c-a]^n;if(e){var f,u=qt[0],h=qt[1],l=qt[2],d=qt[3],p=r.slice(0);o=r.length;for(var c=0,g=o-We;c<o;c+=We,g-=We)if(c===0||c===o-We)p[c]=r[g],p[c+1]=r[g+3],p[c+2]=r[g+2],p[c+3]=r[g+1];else for(var v=0;v<We;++v)f=r[g+v],p[c+(3&-v)]=u[St[f>>>24]]^h[St[f>>>16&255]]^l[St[f>>>8&255]]^d[St[f&255]];r=p}return r}function yi(t,e,r,n){var i=t.length/4-1,a,s,o,c,f;n?(a=qt[0],s=qt[1],o=qt[2],c=qt[3],f=di):(a=_e[0],s=_e[1],o=_e[2],c=_e[3],f=St);var u,h,l,d,p,g,v;u=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],d=e[n?1:3]^t[3];for(var b=3,B=1;B<i;++B)p=a[u>>>24]^s[h>>>16&255]^o[l>>>8&255]^c[d&255]^t[++b],g=a[h>>>24]^s[l>>>16&255]^o[d>>>8&255]^c[u&255]^t[++b],v=a[l>>>24]^s[d>>>16&255]^o[u>>>8&255]^c[h&255]^t[++b],d=a[d>>>24]^s[u>>>16&255]^o[h>>>8&255]^c[l&255]^t[++b],u=p,h=g,l=v;r[0]=f[u>>>24]<<24^f[h>>>16&255]<<16^f[l>>>8&255]<<8^f[d&255]^t[++b],r[n?3:1]=f[h>>>24]<<24^f[l>>>16&255]<<16^f[d>>>8&255]<<8^f[u&255]^t[++b],r[2]=f[l>>>24]<<24^f[d>>>16&255]<<16^f[u>>>8&255]<<8^f[h&255]^t[++b],r[n?1:3]=f[d>>>24]<<24^f[u>>>16&255]<<16^f[h>>>8&255]<<8^f[l&255]^t[++b]}function cn(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=J.cipher.createDecipher(r,t.key):n=J.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof J.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}});var Us=U((rd,Ks)=>{var nt=X();hi();pi();ht();Ks.exports=nt.des=nt.des||{};nt.des.startEncrypting=function(t,e,r,n){var i=un({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};nt.des.createEncryptionCipher=function(t,e){return un({key:t,output:null,decrypt:!1,mode:e})};nt.des.startDecrypting=function(t,e,r,n){var i=un({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};nt.des.createDecryptionCipher=function(t,e){return un({key:t,output:null,decrypt:!0,mode:e})};nt.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return Ps(r._keys,n,i,!1)},decrypt:function(n,i){return Ps(r._keys,n,i,!0)}}}),r._init=!1};nt.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=nt.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Hf(e),this._init=!0}};Qt("DES-ECB",nt.cipher.modes.ecb);Qt("DES-CBC",nt.cipher.modes.cbc);Qt("DES-CFB",nt.cipher.modes.cfb);Qt("DES-OFB",nt.cipher.modes.ofb);Qt("DES-CTR",nt.cipher.modes.ctr);Qt("3DES-ECB",nt.cipher.modes.ecb);Qt("3DES-CBC",nt.cipher.modes.cbc);Qt("3DES-CFB",nt.cipher.modes.cfb);Qt("3DES-OFB",nt.cipher.modes.ofb);Qt("3DES-CTR",nt.cipher.modes.ctr);function Qt(t,e){var r=function(){return new nt.des.Algorithm(t,e)};nt.cipher.registerAlgorithm(t,r)}var Kf=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Uf=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Ff=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Of=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Mf=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Vf=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],qf=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],zf=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Hf(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],f=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=t.length()>8?3:1,v=[],b=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],B=0,A,N=0;N<g;N++){var I=t.getInt32(),_=t.getInt32();A=(I>>>4^_)&252645135,_^=A,I^=A<<4,A=(_>>>-16^I)&65535,I^=A,_^=A<<-16,A=(I>>>2^_)&858993459,_^=A,I^=A<<2,A=(_>>>-16^I)&65535,I^=A,_^=A<<-16,A=(I>>>1^_)&1431655765,_^=A,I^=A<<1,A=(_>>>8^I)&16711935,I^=A,_^=A<<8,A=(I>>>1^_)&1431655765,_^=A,I^=A<<1,A=I<<8|_>>>20&240,I=_<<24|_<<8&16711680|_>>>8&65280|_>>>24&240,_=A;for(var O=0;O<b.length;++O){b[O]?(I=I<<2|I>>>26,_=_<<2|_>>>26):(I=I<<1|I>>>27,_=_<<1|_>>>27),I&=-15,_&=-15;var W=e[I>>>28]|r[I>>>24&15]|n[I>>>20&15]|i[I>>>16&15]|a[I>>>12&15]|s[I>>>8&15]|o[I>>>4&15],xt=c[_>>>28]|f[_>>>24&15]|u[_>>>20&15]|h[_>>>16&15]|l[_>>>12&15]|d[_>>>8&15]|p[_>>>4&15];A=(xt>>>16^W)&65535,v[B++]=W^A,v[B++]=xt^A<<16}}return v}function Ps(t,e,r,n){var i=t.length===32?3:9,a;i===3?a=n?[30,-2,-2]:[0,32,2]:a=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,o=e[0],c=e[1];s=(o>>>4^c)&252645135,c^=s,o^=s<<4,s=(o>>>16^c)&65535,c^=s,o^=s<<16,s=(c>>>2^o)&858993459,o^=s,c^=s<<2,s=(c>>>8^o)&16711935,o^=s,c^=s<<8,s=(o>>>1^c)&1431655765,c^=s,o^=s<<1,o=o<<1|o>>>31,c=c<<1|c>>>31;for(var f=0;f<i;f+=3){for(var u=a[f+1],h=a[f+2],l=a[f];l!=u;l+=h){var d=c^t[l],p=(c>>>4|c<<28)^t[l+1];s=o,o=c,c=s^(Uf[d>>>24&63]|Of[d>>>16&63]|Vf[d>>>8&63]|zf[d&63]|Kf[p>>>24&63]|Ff[p>>>16&63]|Mf[p>>>8&63]|qf[p&63])}s=o,o=c,c=s}o=o>>>1|o<<31,c=c>>>1|c<<31,s=(o>>>1^c)&1431655765,c^=s,o^=s<<1,s=(c>>>8^o)&16711935,o^=s,c^=s<<8,s=(c>>>2^o)&858993459,o^=s,c^=s<<2,s=(o>>>16^c)&65535,c^=s,o^=s<<16,s=(o>>>4^c)&252645135,c^=s,o^=s<<4,r[0]=o,r[1]=c}function un(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=nt.cipher.createDecipher(r,t.key):n=nt.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof nt.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}});var Re=U((nd,Fs)=>{var hn=X();Fs.exports=hn.md=hn.md||{};hn.md.algorithms=hn.md.algorithms||{}});var Ms=U((id,Os)=>{var ae=X();Re();ht();var Gf=Os.exports=ae.hmac=ae.hmac||{};Gf.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(a,s){if(a!==null)if(typeof a=="string")if(a=a.toLowerCase(),a in ae.md.algorithms)e=ae.md.algorithms[a].create();else throw new Error('Unknown hash algorithm "'+a+'"');else e=a;if(s===null)s=t;else{if(typeof s=="string")s=ae.util.createBuffer(s);else if(ae.util.isArray(s)){var o=s;s=ae.util.createBuffer();for(var c=0;c<o.length;++c)s.putByte(o[c])}var f=s.length();f>e.blockLength&&(e.start(),e.update(s.bytes()),s=e.digest()),r=ae.util.createBuffer(),n=ae.util.createBuffer(),f=s.length();for(var c=0;c<f;++c){var o=s.at(c);r.putByte(54^o),n.putByte(92^o)}if(f<e.blockLength)for(var o=e.blockLength-f,c=0;c<o;++c)r.putByte(54),n.putByte(92);t=s,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(a){e.update(a)},i.getMac=function(){var a=e.digest().bytes();return e.start(),e.update(n),e.update(a),e.digest()},i.digest=i.getMac,i}});var Ye=U(()=>{});var qs=U((od,Vs)=>{var Et=X();Ms();Re();ht();var Wf=Et.pkcs5=Et.pkcs5||{},se;Et.util.isNodejs&&!Et.options.usePureJavaScript&&(se=Ye());Vs.exports=Et.pbkdf2=Wf.pbkdf2=function(t,e,r,n,i,a){if(typeof i=="function"&&(a=i,i=null),Et.util.isNodejs&&!Et.options.usePureJavaScript&&se.pbkdf2&&(i===null||typeof i!="object")&&(se.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),a?se.pbkdf2Sync.length===4?se.pbkdf2(t,e,r,n,function(A,N){if(A)return a(A);a(null,N.toString("binary"))}):se.pbkdf2(t,e,r,n,i,function(A,N){if(A)return a(A);a(null,N.toString("binary"))}):se.pbkdf2Sync.length===4?se.pbkdf2Sync(t,e,r,n).toString("binary"):se.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Et.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Et.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var o=new Error("Derived key is too long.");if(a)return a(o);throw o}var c=Math.ceil(n/s),f=n-(c-1)*s,u=Et.hmac.create();u.start(i,t);var h="",l,d,p;if(!a){for(var g=1;g<=c;++g){u.start(null,null),u.update(e),u.update(Et.util.int32ToBytes(g)),l=p=u.digest().getBytes();for(var v=2;v<=r;++v)u.start(null,null),u.update(p),d=u.digest().getBytes(),l=Et.util.xorBytes(l,d,s),p=d;h+=g<c?l:l.substr(0,f)}return h}var g=1,v;function b(){if(g>c)return a(null,h);u.start(null,null),u.update(e),u.update(Et.util.int32ToBytes(g)),l=p=u.digest().getBytes(),v=2,B()}function B(){if(v<=r)return u.start(null,null),u.update(p),d=u.digest().getBytes(),l=Et.util.xorBytes(l,d,s),p=d,++v,Et.util.setImmediate(B);h+=g<c?l:l.substr(0,f),++g,b()}b()}});var Gs=U((fd,Hs)=>{var pn=X();ht();var zs=Hs.exports=pn.pem=pn.pem||{};zs.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=ln(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=ln(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=ln(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=ln(t.headers[i]);return t.procType&&(r+=`\r
`),r+=pn.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};zs.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,a;a=r.exec(t),!!a;){var s=a[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var o={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:pn.util.decode64(a[3])};if(e.push(o),!!a[2]){for(var c=a[2].split(i),f=0;a&&f<c.length;){for(var u=c[f].replace(/\s+$/,""),h=f+1;h<c.length;++h){var l=c[h];if(!/\s/.test(l[0]))break;u+=l,f=h}if(a=u.match(n),a){for(var d={name:a[1],values:[]},p=a[2].split(","),g=0;g<p.length;++g)d.values.push(Zf(p[g]));if(o.procType)if(!o.contentDomain&&d.name==="Content-Domain")o.contentDomain=p[0]||"";else if(!o.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:p[0],parameters:p[1]||null}}else o.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:p[0],type:p[1]}}}++f}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function ln(t){for(var e=t.name+": ",r=[],n=function(c,f){return" "+f},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var a=0,s=-1,i=0;i<e.length;++i,++a)if(a>65&&s!==-1){var o=e[s];o===","?(++s,e=e.substr(0,s)+`\r
 `+e.substr(s)):e=e.substr(0,s)+`\r
`+o+e.substr(s+1),a=i-s-1,s=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(s=i);return e}function Zf(t){return t.replace(/^\s+/,"")}});var Xs=U((cd,Qs)=>{var Xt=X();Re();ht();var Zs=Qs.exports=Xt.sha256=Xt.sha256||{};Xt.md.sha256=Xt.md.algorithms.sha256=Zs;Zs.create=function(){Ys||Yf();var t=null,e=Xt.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return e=Xt.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=Xt.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),Ws(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=Xt.util.createBuffer();i.putBytes(e.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=a&n.blockLength-1;i.putBytes(vi.substr(0,n.blockLength-s));for(var o,c,f=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,c=o/4294967296>>>0,f+=c,i.putInt32(f>>>0),f=o>>>0;i.putInt32(f);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};Ws(h,r,i);var l=Xt.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var vi=null,Ys=!1,$s=null;function Yf(){vi=String.fromCharCode(128),vi+=Xt.util.fillString(String.fromCharCode(0),64),$s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Ys=!0}function Ws(t,e,r){for(var n,i,a,s,o,c,f,u,h,l,d,p,g,v,b,B=r.length();B>=64;){for(f=0;f<16;++f)e[f]=r.getInt32();for(;f<64;++f)n=e[f-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[f-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[f]=n+e[f-7]+i+e[f-16]|0;for(u=t.h0,h=t.h1,l=t.h2,d=t.h3,p=t.h4,g=t.h5,v=t.h6,b=t.h7,f=0;f<64;++f)s=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),o=v^p&(g^v),a=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),c=u&h|l&(u^h),n=b+s+o+$s[f]+e[f],i=a+c,b=v,v=g,g=p,p=d+n>>>0,d=l,l=h,h=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+d|0,t.h4=t.h4+p|0,t.h5=t.h5+g|0,t.h6=t.h6+v|0,t.h7=t.h7+b|0,B-=64}}});var js=U((ud,Js)=>{var Jt=X();ht();var dn=null;Jt.util.isNodejs&&!Jt.options.usePureJavaScript&&!process.versions["node-webkit"]&&(dn=Ye());var $f=Js.exports=Jt.prng=Jt.prng||{};$f.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(f,u){if(!u)return e.generateSync(f);var h=e.plugin.cipher,l=e.plugin.increment,d=e.plugin.formatKey,p=e.plugin.formatSeed,g=Jt.util.createBuffer();e.key=null,v();function v(b){if(b)return u(b);if(g.length()>=f)return u(null,g.getBytes(f));if(e.generated>1048575&&(e.key=null),e.key===null)return Jt.util.nextTick(function(){a(v)});var B=h(e.key,e.seed);e.generated+=B.length,g.putBytes(B),e.key=d(h(e.key,l(e.seed))),e.seed=p(h(e.key,e.seed)),Jt.util.setImmediate(v)}},e.generateSync=function(f){var u=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,d=e.plugin.formatSeed;e.key=null;for(var p=Jt.util.createBuffer();p.length()<f;){e.generated>1048575&&(e.key=null),e.key===null&&s();var g=u(e.key,e.seed);e.generated+=g.length,p.putBytes(g),e.key=l(u(e.key,h(e.seed))),e.seed=d(u(e.key,e.seed))}return p.getBytes(f)};function a(f){if(e.pools[0].messageLength>=32)return o(),f();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,l){if(h)return f(h);e.collect(l),o(),f()})}function s(){if(e.pools[0].messageLength>=32)return o();var f=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(f)),o()}function o(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var f=e.plugin.md.create();f.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u===0&&(f.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=f.digest().getBytes(),f.start(),f.update(e.keyBytes);var l=f.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function c(f){var u=null,h=Jt.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(I){return l.getRandomValues(I)});var d=Jt.util.createBuffer();if(u)for(;d.length()<f;){var p=Math.max(1,Math.min(f-d.length(),65536)/4),g=new Uint32Array(Math.floor(p));try{u(g);for(var v=0;v<g.length;++v)d.putInt32(g[v])}catch(I){if(!(typeof QuotaExceededError<"u"&&I instanceof QuotaExceededError))throw I}}if(d.length()<f)for(var b,B,A,N=Math.floor(Math.random()*65536);d.length()<f;){B=16807*(N&65535),b=16807*(N>>16),B+=(b&32767)<<16,B+=b>>15,B=(B&2147483647)+(B>>31),N=B&4294967295;for(var v=0;v<3;++v)A=N>>>(v<<3),A^=Math.floor(Math.random()*256),d.putByte(A&255)}return d.getBytes(f)}return dn?(e.seedFile=function(f,u){dn.randomBytes(f,function(h,l){if(h)return u(h);u(null,l.toString())})},e.seedFileSync=function(f){return dn.randomBytes(f).toString()}):(e.seedFile=function(f,u){try{u(null,c(f))}catch(h){u(h)}},e.seedFileSync=c),e.collect=function(f){for(var u=f.length,h=0;h<u;++h)e.pools[e.pool].update(f.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(f,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(f>>l&255);e.collect(h)},e.registerWorker=function(f){if(f===self)e.seedFile=function(h,l){function d(p){var g=p.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",d),l(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(d,p){f.postMessage({forge:{prng:{err:d,bytes:p}}})})};f.addEventListener("message",u)}},e}});var Cr=U((hd,mi)=>{var yt=X();xi();Xs();js();ht();(function(){if(yt.random&&yt.random.getBytes){mi.exports=yt.random;return}(function(t){var e={},r=new Array(4),n=yt.util.createBuffer();e.formatKey=function(h){var l=yt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),yt.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=yt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return yt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=yt.md.sha256;function i(){var h=yt.prng.create(e);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var a=i(),s=null,o=yt.util.globalScope,c=o.crypto||o.msCrypto;if(c&&c.getRandomValues&&(s=function(h){return c.getRandomValues(h)}),yt.options.usePureJavaScript||!yt.util.isNodejs&&!s){if(typeof window>"u"||window.document,a.collectInt(+new Date,32),typeof navigator<"u"){var f="";for(var u in navigator)try{typeof navigator[u]=="string"&&(f+=navigator[u])}catch{}a.collect(f),f=null}t&&(t().mousemove(function(h){a.collectInt(h.clientX,16),a.collectInt(h.clientY,16)}),t().keypress(function(h){a.collectInt(h.charCode,8)}))}if(!yt.random)yt.random=a;else for(var u in a)yt.random[u]=a[u];yt.random.createInstance=i,mi.exports=yt.random})(typeof jQuery<"u"?jQuery:null)})()});var no=U((ld,ro)=>{var Ct=X();ht();var bi=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],to=[1,2,3,5],Qf=function(t,e){return t<<e&65535|(t&65535)>>16-e},Xf=function(t,e){return(t&65535)>>e|t<<16-e&65535};ro.exports=Ct.rc2=Ct.rc2||{};Ct.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Ct.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,a=Math.ceil(i/8),s=255>>(i&7),o;for(o=n;o<128;o++)r.putByte(bi[r.at(o-1)+r.at(o-n)&255]);for(r.setAt(128-a,bi[r.at(128-a)&s]),o=127-a;o>=0;o--)r.setAt(o,bi[r.at(o+1)^r.at(o+a)]);return r};var eo=function(t,e,r){var n=!1,i=null,a=null,s=null,o,c,f,u,h=[];for(t=Ct.rc2.expandKey(t,e),f=0;f<64;f++)h.push(t.getInt16Le());r?(o=function(p){for(f=0;f<4;f++)p[f]+=h[u]+(p[(f+3)%4]&p[(f+2)%4])+(~p[(f+3)%4]&p[(f+1)%4]),p[f]=Qf(p[f],to[f]),u++},c=function(p){for(f=0;f<4;f++)p[f]+=h[p[(f+3)%4]&63]}):(o=function(p){for(f=3;f>=0;f--)p[f]=Xf(p[f],to[f]),p[f]-=h[u]+(p[(f+3)%4]&p[(f+2)%4])+(~p[(f+3)%4]&p[(f+1)%4]),u--},c=function(p){for(f=3;f>=0;f--)p[f]-=h[p[(f+3)%4]&63]});var l=function(p){var g=[];for(f=0;f<4;f++){var v=i.getInt16Le();s!==null&&(r?v^=s.getInt16Le():s.putInt16Le(v)),g.push(v&65535)}u=r?0:63;for(var b=0;b<p.length;b++)for(var B=0;B<p[b][0];B++)p[b][1](g);for(f=0;f<4;f++)s!==null&&(r?s.putInt16Le(g[f]):g[f]^=s.getInt16Le()),a.putInt16Le(g[f])},d=null;return d={start:function(p,g){p&&typeof p=="string"&&(p=Ct.util.createBuffer(p)),n=!1,i=Ct.util.createBuffer(),a=g||new Ct.util.createBuffer,s=p,d.output=a},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,o],[1,c],[6,o],[1,c],[5,o]])},finish:function(p){var g=!0;if(r)if(p)g=p(8,i,!r);else{var v=i.length()===8?8:8-i.length();i.fillWithByte(v,v)}if(g&&(n=!0,d.update()),!r&&(g=i.length()===0,g))if(p)g=p(8,a,!r);else{var b=a.length(),B=a.at(b-1);B>b?g=!1:a.truncate(B)}return g}},d};Ct.rc2.startEncrypting=function(t,e,r){var n=Ct.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Ct.rc2.createEncryptionCipher=function(t,e){return eo(t,e,!0)};Ct.rc2.startDecrypting=function(t,e,r){var n=Ct.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Ct.rc2.createDecryptionCipher=function(t,e){return eo(t,e,!1)}});var xn=U((pd,ho)=>{var wi=X();ho.exports=wi.jsbn=wi.jsbn||{};var oe,Jf=0xdeadbeefcafe,io=(Jf&16777215)==15715070;function w(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}wi.jsbn.BigInteger=w;function G(){return new w(null)}function jf(t,e,r,n,i,a){for(;--a>=0;){var s=e*this.data[t++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function tc(t,e,r,n,i,a){for(var s=e&32767,o=e>>15;--a>=0;){var c=this.data[t]&32767,f=this.data[t++]>>15,u=o*c+f*s;c=s*c+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(c>>>30)+(u>>>15)+o*f+(i>>>30),r.data[n++]=c&1073741823}return i}function ao(t,e,r,n,i,a){for(var s=e&16383,o=e>>14;--a>=0;){var c=this.data[t]&16383,f=this.data[t++]>>14,u=o*c+f*s;c=s*c+((u&16383)<<14)+r.data[n]+i,i=(c>>28)+(u>>14)+o*f,r.data[n++]=c&268435455}return i}typeof navigator>"u"?(w.prototype.am=ao,oe=28):io&&navigator.appName=="Microsoft Internet Explorer"?(w.prototype.am=tc,oe=30):io&&navigator.appName!="Netscape"?(w.prototype.am=jf,oe=26):(w.prototype.am=ao,oe=28);w.prototype.DB=oe;w.prototype.DM=(1<<oe)-1;w.prototype.DV=1<<oe;var Si=52;w.prototype.FV=Math.pow(2,Si);w.prototype.F1=Si-oe;w.prototype.F2=2*oe-Si;var ec="0123456789abcdefghijklmnopqrstuvwxyz",yn=new Array,$e,Pt;$e="0".charCodeAt(0);for(Pt=0;Pt<=9;++Pt)yn[$e++]=Pt;$e="a".charCodeAt(0);for(Pt=10;Pt<36;++Pt)yn[$e++]=Pt;$e="A".charCodeAt(0);for(Pt=10;Pt<36;++Pt)yn[$e++]=Pt;function so(t){return ec.charAt(t)}function oo(t,e){var r=yn[t.charCodeAt(e)];return r??-1}function rc(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function nc(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function ge(t){var e=G();return e.fromInt(t),e}function ic(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,a=0;--n>=0;){var s=r==8?t[n]&255:oo(t,n);if(s<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,a==0?this.data[this.t++]=s:a+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-a)-1)<<a,this.data[this.t++]=s>>this.DB-a):this.data[this.t-1]|=s<<a,a+=r,a>=this.DB&&(a-=this.DB)}r==8&&t[0]&128&&(this.s=-1,a>0&&(this.data[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),i&&w.ZERO.subTo(this,this)}function ac(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function sc(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,a="",s=this.t,o=this.DB-s*this.DB%e;if(s-- >0)for(o<this.DB&&(n=this.data[s]>>o)>0&&(i=!0,a=so(n));s>=0;)o<e?(n=(this.data[s]&(1<<o)-1)<<e-o,n|=this.data[--s]>>(o+=this.DB-e)):(n=this.data[s]>>(o-=e)&r,o<=0&&(o+=this.DB,--s)),n>0&&(i=!0),i&&(a+=so(n));return i?a:"0"}function oc(){var t=G();return w.ZERO.subTo(this,t),t}function fc(){return this.s<0?this.negate():this}function cc(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function gn(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function uc(){return this.t<=0?0:this.DB*(this.t-1)+gn(this.data[this.t-1]^this.s&this.DM)}function hc(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function lc(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function pc(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,a=Math.floor(t/this.DB),s=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)e.data[o+a+1]=this.data[o]>>n|s,s=(this.data[o]&i)<<r;for(o=a-1;o>=0;--o)e.data[o]=0;e.data[a]=s,e.t=this.t+a+1,e.s=this.s,e.clamp()}function dc(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,a=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)e.data[s-r-1]|=(this.data[s]&a)<<i,e.data[s-r]=this.data[s]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&a)<<i),e.t=this.t-r,e.clamp()}function yc(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function gc(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&w.ZERO.subTo(e,e)}function xc(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function vc(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=G());var a=G(),s=this.s,o=t.s,c=this.DB-gn(n.data[n.t-1]);c>0?(n.lShiftTo(c,a),i.lShiftTo(c,r)):(n.copyTo(a),i.copyTo(r));var f=a.t,u=a.data[f-1];if(u!=0){var h=u*(1<<this.F1)+(f>1?a.data[f-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,g=r.t,v=g-f,b=e??G();for(a.dlShiftTo(v,b),r.compareTo(b)>=0&&(r.data[r.t++]=1,r.subTo(b,r)),w.ONE.dlShiftTo(f,b),b.subTo(a,a);a.t<f;)a.data[a.t++]=0;for(;--v>=0;){var B=r.data[--g]==u?this.DM:Math.floor(r.data[g]*l+(r.data[g-1]+p)*d);if((r.data[g]+=a.am(0,B,r,v,0,f))<B)for(a.dlShiftTo(v,b),r.subTo(b,r);r.data[g]<--B;)r.subTo(b,r)}e!=null&&(r.drShiftTo(f,e),s!=o&&w.ZERO.subTo(e,e)),r.t=f,r.clamp(),c>0&&r.rShiftTo(c,r),s<0&&w.ZERO.subTo(r,r)}}}function mc(t){var e=G();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(w.ZERO)>0&&t.subTo(e,e),e}function ke(t){this.m=t}function bc(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function wc(t){return t}function Sc(t){t.divRemTo(this.m,null,t)}function Ec(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function Bc(t,e){t.squareTo(e),this.reduce(e)}ke.prototype.convert=bc;ke.prototype.revert=wc;ke.prototype.reduce=Sc;ke.prototype.mulTo=Ec;ke.prototype.sqrTo=Bc;function Ac(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function De(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function Cc(t){var e=G();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(w.ZERO)>0&&this.m.subTo(e,e),e}function Tc(t){var e=G();return t.copyTo(e),this.reduce(e),e}function Ic(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function _c(t,e){t.squareTo(e),this.reduce(e)}function Rc(t,e,r){t.multiplyTo(e,r),this.reduce(r)}De.prototype.convert=Cc;De.prototype.revert=Tc;De.prototype.reduce=Ic;De.prototype.mulTo=Rc;De.prototype.sqrTo=_c;function kc(){return(this.t>0?this.data[0]&1:this.s)==0}function Dc(t,e){if(t>4294967295||t<1)return w.ONE;var r=G(),n=G(),i=e.convert(this),a=gn(t)-1;for(i.copyTo(r);--a>=0;)if(e.sqrTo(r,n),(t&1<<a)>0)e.mulTo(n,i,r);else{var s=r;r=n,n=s}return e.revert(r)}function Nc(t,e){var r;return t<256||e.isEven()?r=new ke(e):r=new De(e),this.exp(t,r)}w.prototype.copyTo=rc;w.prototype.fromInt=nc;w.prototype.fromString=ic;w.prototype.clamp=ac;w.prototype.dlShiftTo=hc;w.prototype.drShiftTo=lc;w.prototype.lShiftTo=pc;w.prototype.rShiftTo=dc;w.prototype.subTo=yc;w.prototype.multiplyTo=gc;w.prototype.squareTo=xc;w.prototype.divRemTo=vc;w.prototype.invDigit=Ac;w.prototype.isEven=kc;w.prototype.exp=Dc;w.prototype.toString=sc;w.prototype.negate=oc;w.prototype.abs=fc;w.prototype.compareTo=cc;w.prototype.bitLength=uc;w.prototype.mod=mc;w.prototype.modPowInt=Nc;w.ZERO=ge(0);w.ONE=ge(1);function Lc(){var t=G();return this.copyTo(t),t}function Pc(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Kc(){return this.t==0?this.s:this.data[0]<<24>>24}function Uc(){return this.t==0?this.s:this.data[0]<<16>>16}function Fc(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function Oc(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Mc(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=ge(r),i=G(),a=G(),s="";for(this.divRemTo(n,i,a);i.signum()>0;)s=(r+a.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,a);return a.intValue().toString(t)+s}function Vc(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,a=0,s=0,o=0;o<t.length;++o){var c=oo(t,o);if(c<0){t.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}s=e*s+c,++a>=r&&(this.dMultiply(n),this.dAddOffset(s,0),a=0,s=0)}a>0&&(this.dMultiply(Math.pow(e,a)),this.dAddOffset(s,0)),i&&w.ZERO.subTo(this,this)}function qc(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(w.ONE.shiftLeft(t-1),Ei,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(w.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function zc(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function Hc(t){return this.compareTo(t)==0}function Gc(t){return this.compareTo(t)<0?this:t}function Wc(t){return this.compareTo(t)>0?this:t}function Zc(t,e,r){var n,i,a=Math.min(t.t,this.t);for(n=0;n<a;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=a;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=a;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function Yc(t,e){return t&e}function $c(t){var e=G();return this.bitwiseTo(t,Yc,e),e}function Ei(t,e){return t|e}function Qc(t){var e=G();return this.bitwiseTo(t,Ei,e),e}function fo(t,e){return t^e}function Xc(t){var e=G();return this.bitwiseTo(t,fo,e),e}function co(t,e){return t&~e}function Jc(t){var e=G();return this.bitwiseTo(t,co,e),e}function jc(){for(var t=G(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function tu(t){var e=G();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function eu(t){var e=G();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function ru(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function nu(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+ru(this.data[t]);return this.s<0?this.t*this.DB:-1}function iu(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function au(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=iu(this.data[r]^e);return t}function su(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function ou(t,e){var r=w.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function fu(t){return this.changeBit(t,Ei)}function cu(t){return this.changeBit(t,co)}function uu(t){return this.changeBit(t,fo)}function hu(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function lu(t){var e=G();return this.addTo(t,e),e}function pu(t){var e=G();return this.subTo(t,e),e}function du(t){var e=G();return this.multiplyTo(t,e),e}function yu(t){var e=G();return this.divRemTo(t,e,null),e}function gu(t){var e=G();return this.divRemTo(t,null,e),e}function xu(t){var e=G(),r=G();return this.divRemTo(t,e,r),new Array(e,r)}function vu(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function mu(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Tr(){}function uo(t){return t}function bu(t,e,r){t.multiplyTo(e,r)}function wu(t,e){t.squareTo(e)}Tr.prototype.convert=uo;Tr.prototype.revert=uo;Tr.prototype.mulTo=bu;Tr.prototype.sqrTo=wu;function Su(t){return this.exp(t,new Tr)}function Eu(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function Bu(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Qe(t){this.r2=G(),this.q3=G(),w.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Au(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=G();return t.copyTo(e),this.reduce(e),e}function Cu(t){return t}function Tu(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Iu(t,e){t.squareTo(e),this.reduce(e)}function _u(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Qe.prototype.convert=Au;Qe.prototype.revert=Cu;Qe.prototype.reduce=Tu;Qe.prototype.mulTo=_u;Qe.prototype.sqrTo=Iu;function Ru(t,e){var r=t.bitLength(),n,i=ge(1),a;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?a=new ke(e):e.isEven()?a=new Qe(e):a=new De(e);var s=new Array,o=3,c=n-1,f=(1<<n)-1;if(s[1]=a.convert(this),n>1){var u=G();for(a.sqrTo(s[1],u);o<=f;)s[o]=G(),a.mulTo(u,s[o-2],s[o]),o+=2}var h=t.t-1,l,d=!0,p=G(),g;for(r=gn(t.data[h])-1;h>=0;){for(r>=c?l=t.data[h]>>r-c&f:(l=(t.data[h]&(1<<r+1)-1)<<c-r,h>0&&(l|=t.data[h-1]>>this.DB+r-c)),o=n;!(l&1);)l>>=1,--o;if((r-=o)<0&&(r+=this.DB,--h),d)s[l].copyTo(i),d=!1;else{for(;o>1;)a.sqrTo(i,p),a.sqrTo(p,i),o-=2;o>0?a.sqrTo(i,p):(g=i,i=p,p=g),a.mulTo(p,s[l],i)}for(;h>=0&&!(t.data[h]&1<<r);)a.sqrTo(i,p),g=i,i=p,p=g,--r<0&&(r=this.DB-1,--h)}return a.revert(i)}function ku(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return e;for(i<a&&(a=i),a>0&&(e.rShiftTo(a,e),r.rShiftTo(a,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r}function Du(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function Nu(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return w.ZERO;for(var r=t.clone(),n=this.clone(),i=ge(1),a=ge(0),s=ge(0),o=ge(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!a.isEven())&&(i.addTo(this,i),a.subTo(t,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);for(;n.isEven();)n.rShiftTo(1,n),e?((!s.isEven()||!o.isEven())&&(s.addTo(this,s),o.subTo(t,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(s,i),a.subTo(o,a)):(n.subTo(r,n),e&&s.subTo(i,s),o.subTo(a,o))}if(n.compareTo(w.ONE)!=0)return w.ZERO;if(o.compareTo(t)>=0)return o.subtract(t);if(o.signum()<0)o.addTo(t,o);else return o;return o.signum()<0?o.add(t):o}var zt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Lu=(1<<26)/zt[zt.length-1];function Pu(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=zt[zt.length-1]){for(e=0;e<zt.length;++e)if(r.data[0]==zt[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<zt.length;){for(var n=zt[e],i=e+1;i<zt.length&&n<Lu;)n*=zt[i++];for(n=r.modInt(n);e<i;)if(n%zt[e++]==0)return!1}return r.millerRabin(t)}function Ku(t){var e=this.subtract(w.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=Uu(),a,s=0;s<t;++s){do a=new w(this.bitLength(),i);while(a.compareTo(w.ONE)<=0||a.compareTo(e)>=0);var o=a.modPow(n,this);if(o.compareTo(w.ONE)!=0&&o.compareTo(e)!=0){for(var c=1;c++<r&&o.compareTo(e)!=0;)if(o=o.modPowInt(2,this),o.compareTo(w.ONE)==0)return!1;if(o.compareTo(e)!=0)return!1}}return!0}function Uu(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}w.prototype.chunkSize=Fc;w.prototype.toRadix=Mc;w.prototype.fromRadix=Vc;w.prototype.fromNumber=qc;w.prototype.bitwiseTo=Zc;w.prototype.changeBit=ou;w.prototype.addTo=hu;w.prototype.dMultiply=vu;w.prototype.dAddOffset=mu;w.prototype.multiplyLowerTo=Eu;w.prototype.multiplyUpperTo=Bu;w.prototype.modInt=Du;w.prototype.millerRabin=Ku;w.prototype.clone=Lc;w.prototype.intValue=Pc;w.prototype.byteValue=Kc;w.prototype.shortValue=Uc;w.prototype.signum=Oc;w.prototype.toByteArray=zc;w.prototype.equals=Hc;w.prototype.min=Gc;w.prototype.max=Wc;w.prototype.and=$c;w.prototype.or=Qc;w.prototype.xor=Xc;w.prototype.andNot=Jc;w.prototype.not=jc;w.prototype.shiftLeft=tu;w.prototype.shiftRight=eu;w.prototype.getLowestSetBit=nu;w.prototype.bitCount=au;w.prototype.testBit=su;w.prototype.setBit=fu;w.prototype.clearBit=cu;w.prototype.flipBit=uu;w.prototype.add=lu;w.prototype.subtract=pu;w.prototype.multiply=du;w.prototype.divide=yu;w.prototype.remainder=gu;w.prototype.divideAndRemainder=xu;w.prototype.modPow=Ru;w.prototype.modInverse=Nu;w.prototype.pow=Su;w.prototype.gcd=ku;w.prototype.isProbablePrime=Pu});var xo=U((dd,go)=>{var jt=X();Re();ht();var po=go.exports=jt.sha1=jt.sha1||{};jt.md.sha1=jt.md.algorithms.sha1=po;po.create=function(){yo||Fu();var t=null,e=jt.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return e=jt.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=jt.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),lo(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=jt.util.createBuffer();i.putBytes(e.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=a&n.blockLength-1;i.putBytes(Bi.substr(0,n.blockLength-s));for(var o,c,f=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,c=o/4294967296>>>0,f+=c,i.putInt32(f>>>0),f=o>>>0;i.putInt32(f);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};lo(h,r,i);var l=jt.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var Bi=null,yo=!1;function Fu(){Bi=String.fromCharCode(128),Bi+=jt.util.fillString(String.fromCharCode(0),64),yo=!0}function lo(t,e,r){for(var n,i,a,s,o,c,f,u,h=r.length();h>=64;){for(i=t.h0,a=t.h1,s=t.h2,o=t.h3,c=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,f=o^a&(s^o),n=(i<<5|i>>>27)+f+c+1518500249+n,c=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,f=o^a&(s^o),n=(i<<5|i>>>27)+f+c+1518500249+n,c=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,f=a^s^o,n=(i<<5|i>>>27)+f+c+1859775393+n,c=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=a^s^o,n=(i<<5|i>>>27)+f+c+1859775393+n,c=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=a&s|o&(a^s),n=(i<<5|i>>>27)+f+c+2400959708+n,c=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=a^s^o,n=(i<<5|i>>>27)+f+c+3395469782+n,c=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+a|0,t.h2=t.h2+s|0,t.h3=t.h3+o|0,t.h4=t.h4+c|0,h-=64}}});var bo=U((yd,mo)=>{var te=X();ht();Cr();xo();var vo=mo.exports=te.pkcs1=te.pkcs1||{};vo.encode_rsa_oaep=function(t,e,r){var n,i,a,s;typeof r=="string"?(n=r,i=arguments[3]||void 0,a=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),a?a.start():a=te.md.sha1.create(),s||(s=a);var o=Math.ceil(t.n.bitLength()/8),c=o-2*a.digestLength-2;if(e.length>c){var f=new Error("RSAES-OAEP input message length is too long.");throw f.length=e.length,f.maxLength=c,f}n||(n=""),a.update(n,"raw");for(var u=a.digest(),h="",l=c-e.length,d=0;d<l;d++)h+="\0";var p=u.getBytes()+h+""+e;if(!i)i=te.random.getBytes(a.digestLength);else if(i.length!==a.digestLength){var f=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw f.seedLength=i.length,f.digestLength=a.digestLength,f}var g=vn(i,o-a.digestLength-1,s),v=te.util.xorBytes(p,g,p.length),b=vn(v,a.digestLength,s),B=te.util.xorBytes(i,b,i.length);return"\0"+B+v};vo.decode_rsa_oaep=function(t,e,r){var n,i,a;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md));var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var v=new Error("RSAES-OAEP encoded message length is invalid.");throw v.length=e.length,v.expectedLength=s,v}if(i===void 0?i=te.md.sha1.create():i.start(),a||(a=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var o=i.digest().getBytes(),c=e.charAt(0),f=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),h=vn(u,i.digestLength,a),l=te.util.xorBytes(f,h,f.length),d=vn(l,s-i.digestLength-1,a),p=te.util.xorBytes(u,d,u.length),g=p.substring(0,i.digestLength),v=c!=="\0",b=0;b<i.digestLength;++b)v|=o.charAt(b)!==g.charAt(b);for(var B=1,A=i.digestLength,N=i.digestLength;N<p.length;N++){var I=p.charCodeAt(N),_=I&1^1,O=B?65534:0;v|=I&O,B=B&_,A+=B}if(v||p.charCodeAt(A)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(A+1)};function vn(t,e,r){r||(r=te.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),a=0;a<i;++a){var s=String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255);r.start(),r.update(t+s),n+=r.digest().getBytes()}return n.substring(0,e)}});var wo=U((gd,Ai)=>{var xe=X();ht();xn();Cr();(function(){if(xe.prime){Ai.exports=xe.prime;return}var t=Ai.exports=xe.prime=xe.prime||{},e=xe.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,l){return h|l};t.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var g=l.prng||xe.random,v={nextBytes:function(b){for(var B=g.getBytesSync(b.length),A=0;A<b.length;++A)b[A]=B.charCodeAt(A)}};if(p.name==="PRIMEINC")return a(h,v,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function a(h,l,d,p){return"workers"in d?c(h,l,d,p):s(h,l,d,p)}function s(h,l,d,p){var g=f(h,l),v=0,b=u(g.bitLength());"millerRabinTests"in d&&(b=d.millerRabinTests);var B=10;"maxBlockTime"in d&&(B=d.maxBlockTime),o(g,h,l,v,b,B,p)}function o(h,l,d,p,g,v,b){var B=+new Date;do{if(h.bitLength()>l&&(h=f(l,d)),h.isProbablePrime(g))return b(null,h);h.dAddOffset(r[p++%8],0)}while(v<0||+new Date-B<v);xe.util.setImmediate(function(){o(h,l,d,p,g,v,b)})}function c(h,l,d,p){if(typeof Worker>"u")return s(h,l,d,p);var g=f(h,l),v=d.workers,b=d.workLoad||100,B=b*30/8,A=d.workerScript||"forge/prime.worker.js";if(v===-1)return xe.util.estimateCores(function(I,_){I&&(_=2),v=_-1,N()});N();function N(){v=Math.max(1,v);for(var I=[],_=0;_<v;++_)I[_]=new Worker(A);for(var O=v,_=0;_<v;++_)I[_].addEventListener("message",xt);var W=!1;function xt(Ot){if(!W){--O;var _t=Ot.data;if(_t.found){for(var wt=0;wt<I.length;++wt)I[wt].terminate();return W=!0,p(null,new e(_t.prime,16))}g.bitLength()>h&&(g=f(h,l));var Me=g.toString(16);Ot.target.postMessage({hex:Me,workLoad:b}),g.dAddOffset(B,0)}}}}function f(h,l){var d=new e(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(e.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var bn=U((xd,Io)=>{var D=X();Ar();xn();an();bo();wo();Cr();ht();typeof M>"u"&&(M=D.jsbn.BigInteger);var M,Ci=D.util.isNodejs?Ye():null,x=D.asn1,Kt=D.util;D.pki=D.pki||{};Io.exports=D.pki.rsa=D.rsa=D.rsa||{};var P=D.pki,Ou=[6,4,2,4,2,4,6,2],Mu={name:"PrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Vu={name:"RSAPrivateKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},qu={name:"RSAPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},zu=D.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Hu={name:"DigestInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:x.Class.UNIVERSAL,type:x.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:x.Class.UNIVERSAL,type:x.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Gu=function(t){var e;if(t.algorithm in P.oids)e=P.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=x.oidToDer(e).getBytes(),i=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[]),a=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[]);a.value.push(x.create(x.Class.UNIVERSAL,x.Type.OID,!1,n)),a.value.push(x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,""));var s=x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(a),i.value.push(s),x.toDer(i).getBytes()},Co=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(M.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(M.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new M(D.util.bytesToHex(D.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(M.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),a=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(a)<0;)i=i.add(e.p);var s=i.subtract(a).multiply(e.qInv).mod(e.p).multiply(e.q).add(a);return s=s.multiply(n.modInverse(e.n)).mod(e.n),s};P.rsa.encrypt=function(t,e,r){var n=r,i,a=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=To(t,e,r)):(i=D.util.createBuffer(),i.putBytes(t));for(var s=new M(i.toHex(),16),o=Co(s,e,n),c=o.toString(16),f=D.util.createBuffer(),u=a-Math.ceil(c.length/2);u>0;)f.putByte(0),--u;return f.putBytes(D.util.hexToBytes(c)),f.getBytes()};P.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var a=new Error("Encrypted message length is invalid.");throw a.length=t.length,a.expected=i,a}var s=new M(D.util.createBuffer(t).toHex(),16);if(s.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=Co(s,e,r),c=o.toString(16),f=D.util.createBuffer(),u=i-Math.ceil(c.length/2);u>0;)f.putByte(0),--u;return f.putBytes(D.util.hexToBytes(c)),n!==!1?mn(f.getBytes(),e,r):f.getBytes()};P.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||D.random,i={nextBytes:function(o){for(var c=n.getBytesSync(o.length),f=0;f<o.length;++f)o[f]=c.charCodeAt(f)}},a=r.algorithm||"PRIMEINC",s;if(a==="PRIMEINC")s={algorithm:a,state:0,bits:t,rng:i,eInt:e||65537,e:new M(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+a);return s};P.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new M(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},a=+new Date,s,o=0;t.keys===null&&(e<=0||o<e);){if(t.state===0){var c=t.p===null?t.pBits:t.qBits,f=c-1;t.pqState===0?(t.num=new M(c,t.rng),t.num.testBit(f)||t.num.bitwiseTo(M.ONE.shiftLeft(f),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>c?t.pqState=0:t.num.isProbablePrime(Zu(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(Ou[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(M.ONE).gcd(t.e).compareTo(M.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(M.ONE),t.q1=t.q.subtract(M.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(M.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:P.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:P.rsa.setPublicKey(t.n,t.e)}}s=+new Date,o+=s-a,a=s}return t.keys!==null};P.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!D.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(So("generateKeyPair"))return Ci.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,c,f){if(o)return n(o);n(null,{privateKey:P.privateKeyFromPem(f),publicKey:P.publicKeyFromPem(c)})});if(Eo("generateKey")&&Eo("exportKey"))return Kt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Ao(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return Kt.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){n(o)}).then(function(o){if(o){var c=P.privateKeyFromAsn1(x.fromDer(D.util.createBuffer(o)));n(null,{privateKey:c,publicKey:P.setRsaPublicKey(c.n,c.e)})}});if(Bo("generateKey")&&Bo("exportKey")){var i=Kt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Ao(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(o){var c=o.target.result,f=Kt.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);f.oncomplete=function(u){var h=u.target.result,l=P.privateKeyFromAsn1(x.fromDer(D.util.createBuffer(h)));n(null,{privateKey:l,publicKey:P.setRsaPublicKey(l.n,l.e)})},f.onerror=function(u){n(u)}},i.onerror=function(o){n(o)};return}}else if(So("generateKeyPairSync")){var a=Ci.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:P.privateKeyFromPem(a.privateKey),publicKey:P.publicKeyFromPem(a.publicKey)}}}var s=P.rsa.createKeyPairGenerationState(t,e,r);if(!n)return P.rsa.stepKeyPairGenerationState(s,0),s.keys;Wu(s,r,n)};P.setRsaPublicKey=P.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,a){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(o,c,f){return To(o,c,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(o,c){return D.pkcs1.encode_rsa_oaep(c,o,a)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(o){return o}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return P.rsa.encrypt(s,r,!0)},r.verify=function(n,i,a,s){typeof a=="string"?a=a.toUpperCase():a===void 0&&(a="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),a==="RSASSA-PKCS1-V1_5"?a={verify:function(c,f){f=mn(f,r,!0);var u=x.fromDer(f,{parseAllBytes:s._parseAllDigestBytes}),h={},l=[];if(!x.validate(u,Hu,h,l)){var d=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw d.errors=l,d}var p=x.derToOid(h.algorithmIdentifier);if(!(p===D.oids.md2||p===D.oids.md5||p===D.oids.sha1||p===D.oids.sha224||p===D.oids.sha256||p===D.oids.sha384||p===D.oids.sha512||p===D.oids["sha512-224"]||p===D.oids["sha512-256"])){var d=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw d.oid=p,d}if((p===D.oids.md2||p===D.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return c===h.digest}}:(a==="NONE"||a==="NULL"||a===null)&&(a={verify:function(c,f){return f=mn(f,r,!0),c===f}});var o=P.rsa.decrypt(i,r,!0,!1);return a.verify(n,o,r.n.bitLength())},r};P.setRsaPrivateKey=P.rsa.setPrivateKey=function(t,e,r,n,i,a,s,o){var c={n:t,e,d:r,p:n,q:i,dP:a,dQ:s,qInv:o};return c.decrypt=function(f,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=P.rsa.decrypt(f,c,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:mn};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(d,p){return D.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,c,!1)},c.sign=function(f,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:Gu},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return f}},h=1);var l=u.encode(f,c.n.bitLength());return P.rsa.encrypt(l,c,h)},c};P.wrapRsaPrivateKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,x.integerToDer(0).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(P.oids.rsaEncryption).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")]),x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,x.toDer(t).getBytes())])};P.privateKeyFromAsn1=function(t){var e={},r=[];if(x.validate(t,Mu,e,r)&&(t=x.fromDer(D.util.createBuffer(e.privateKey))),e={},r=[],!x.validate(t,Vu,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,a,s,o,c,f,u,h;return i=D.util.createBuffer(e.privateKeyModulus).toHex(),a=D.util.createBuffer(e.privateKeyPublicExponent).toHex(),s=D.util.createBuffer(e.privateKeyPrivateExponent).toHex(),o=D.util.createBuffer(e.privateKeyPrime1).toHex(),c=D.util.createBuffer(e.privateKeyPrime2).toHex(),f=D.util.createBuffer(e.privateKeyExponent1).toHex(),u=D.util.createBuffer(e.privateKeyExponent2).toHex(),h=D.util.createBuffer(e.privateKeyCoefficient).toHex(),P.setRsaPrivateKey(new M(i,16),new M(a,16),new M(s,16),new M(o,16),new M(c,16),new M(f,16),new M(u,16),new M(h,16))};P.privateKeyToAsn1=P.privateKeyToRSAPrivateKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,x.integerToDer(0).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ee(t.n)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ee(t.e)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ee(t.d)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ee(t.p)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ee(t.q)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ee(t.dP)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ee(t.dQ)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ee(t.qInv))])};P.publicKeyFromAsn1=function(t){var e={},r=[];if(x.validate(t,zu,e,r)){var n=x.derToOid(e.publicKeyOid);if(n!==P.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!x.validate(t,qu,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var a=D.util.createBuffer(e.publicKeyModulus).toHex(),s=D.util.createBuffer(e.publicKeyExponent).toHex();return P.setRsaPublicKey(new M(a,16),new M(s,16))};P.publicKeyToAsn1=P.publicKeyToSubjectPublicKeyInfo=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(P.oids.rsaEncryption).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")]),x.create(x.Class.UNIVERSAL,x.Type.BITSTRING,!1,[P.publicKeyToRSAPublicKey(t)])])};P.publicKeyToRSAPublicKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ee(t.n)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,ee(t.e))])};function To(t,e,r){var n=D.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var a=new Error("Message is too long for PKCS#1 v1.5 padding.");throw a.length=t.length,a.max=i-11,a}n.putByte(0),n.putByte(r);var s=i-3-t.length,o;if(r===0||r===1){o=r===0?0:255;for(var c=0;c<s;++c)n.putByte(o)}else for(;s>0;){for(var f=0,u=D.random.getBytes(s),c=0;c<s;++c)o=u.charCodeAt(c),o===0?++f:n.putByte(o);s=f}return n.putByte(0),n.putBytes(t),n}function mn(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),a=D.util.createBuffer(t),s=a.getByte(),o=a.getByte();if(s!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var c=0;if(o===0){c=i-3-n;for(var f=0;f<c;++f)if(a.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(c=0;a.length()>1;){if(a.getByte()!==255){--a.read;break}++c}else if(o===2)for(c=0;a.length()>1;){if(a.getByte()===0){--a.read;break}++c}var u=a.getByte();if(u!==0||c!==i-3-a.length())throw new Error("Encryption block is invalid.");return a.getBytes()}function Wu(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){a(t.pBits,function(o,c){if(o)return r(o);if(t.p=c,t.q!==null)return s(o,t.q);a(t.qBits,s)})}function a(o,c){D.prime.generateProbablePrime(o,n,c)}function s(o,c){if(o)return r(o);if(t.q=c,t.p.compareTo(t.q)<0){var f=t.p;t.p=t.q,t.q=f}if(t.p.subtract(M.ONE).gcd(t.e).compareTo(M.ONE)!==0){t.p=null,i();return}if(t.q.subtract(M.ONE).gcd(t.e).compareTo(M.ONE)!==0){t.q=null,a(t.qBits,s);return}if(t.p1=t.p.subtract(M.ONE),t.q1=t.q.subtract(M.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(M.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,a(t.qBits,s);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:P.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:P.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function ee(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=D.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Zu(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function So(t){return D.util.isNodejs&&typeof Ci[t]=="function"}function Eo(t){return typeof Kt.globalScope<"u"&&typeof Kt.globalScope.crypto=="object"&&typeof Kt.globalScope.crypto.subtle=="object"&&typeof Kt.globalScope.crypto.subtle[t]=="function"}function Bo(t){return typeof Kt.globalScope<"u"&&typeof Kt.globalScope.msCrypto=="object"&&typeof Kt.globalScope.msCrypto.subtle=="object"&&typeof Kt.globalScope.msCrypto.subtle[t]=="function"}function Ao(t){for(var e=D.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var Lo=U((vd,No)=>{var T=X();xi();Ar();Us();Re();an();qs();Gs();Cr();no();bn();ht();typeof _o>"u"&&(_o=T.jsbn.BigInteger);var _o,m=T.asn1,K=T.pki=T.pki||{};No.exports=K.pbe=T.pbe=T.pbe||{};var Ne=K.oids,Yu={name:"EncryptedPrivateKeyInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},$u={name:"PBES2Algorithms",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Qu={name:"pkcs-12PbeParams",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"iterations"}]};K.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=T.random.getBytesSync(r.saltSize),i=r.count,a=m.integerToDer(i),s,o,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var f,u,h;switch(r.algorithm){case"aes128":s=16,f=16,u=Ne["aes128-CBC"],h=T.aes.createEncryptionCipher;break;case"aes192":s=24,f=16,u=Ne["aes192-CBC"],h=T.aes.createEncryptionCipher;break;case"aes256":s=32,f=16,u=Ne["aes256-CBC"],h=T.aes.createEncryptionCipher;break;case"des":s=8,f=8,u=Ne.desCBC,h=T.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=Do(d),g=T.pkcs5.pbkdf2(e,n,i,s,p),v=T.random.getBytesSync(f),b=h(g);b.start(v),b.update(m.toDer(t)),b.finish(),c=b.output.getBytes();var B=Xu(n,a,s,d);o=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OID,!1,m.oidToDer(Ne.pkcs5PBES2).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OID,!1,m.oidToDer(Ne.pkcs5PBKDF2).getBytes()),B]),m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OID,!1,m.oidToDer(u).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,!1,v)])])])}else if(r.algorithm==="3des"){s=24;var A=new T.util.ByteBuffer(n),g=K.pbe.generatePkcs12Key(e,A,1,i,s),v=K.pbe.generatePkcs12Key(e,A,2,i,s),b=T.des.createEncryptionCipher(g);b.start(v),b.update(m.toDer(t)),b.finish(),c=b.output.getBytes(),o=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OID,!1,m.oidToDer(Ne["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,!1,n),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,a.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var N=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[o,m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,!1,c)]);return N};K.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!m.validate(t,Yu,n,i)){var a=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=m.derToOid(n.encryptionOid),o=K.pbe.getCipher(s,n.encryptionParams,e),c=T.util.createBuffer(n.encryptedData);return o.update(c),o.finish()&&(r=m.fromDer(o.output)),r};K.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:m.toDer(t).getBytes()};return T.pem.encode(r,{maxline:e})};K.encryptedPrivateKeyFromPem=function(t){var e=T.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return m.fromDer(e.body)};K.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=K.wrapRsaPrivateKey(K.privateKeyToAsn1(t));return n=K.encryptPrivateKeyInfo(n,e,r),K.encryptedPrivateKeyToPem(n)}var i,a,s,o;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,a=T.random.getBytesSync(16),o=T.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,a=T.random.getBytesSync(16),o=T.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,a=T.random.getBytesSync(16),o=T.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,a=T.random.getBytesSync(8),o=T.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,a=T.random.getBytesSync(8),o=T.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var f=T.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=o(f);u.start(a),u.update(m.toDer(K.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:T.util.bytesToHex(a).toUpperCase()},body:u.output.getBytes()};return T.pem.encode(h)};K.decryptRsaPrivateKey=function(t,e){var r=null,n=T.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var a,s;switch(n.dekInfo.algorithm){case"DES-CBC":a=8,s=T.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,s=T.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,s=T.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,s=T.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,s=T.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,s=function(h){return T.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":a=8,s=function(h){return T.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":a=16,s=function(h){return T.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var o=T.util.hexToBytes(n.dekInfo.parameters),c=T.pbe.opensslDeriveBytes(e,o.substr(0,8),a),f=s(c);if(f.start(o),f.update(T.util.createBuffer(n.body)),f.finish())r=f.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=K.decryptPrivateKeyInfo(m.fromDer(r),e):r=m.fromDer(r),r!==null&&(r=K.privateKeyFromAsn1(r)),r};K.pbe.generatePkcs12Key=function(t,e,r,n,i,a){var s,o;if(typeof a>"u"||a===null){if(!("sha1"in T.md))throw new Error('"sha1" hash algorithm unavailable.');a=T.md.sha1.create()}var c=a.digestLength,f=a.blockLength,u=new T.util.ByteBuffer,h=new T.util.ByteBuffer;if(t!=null){for(o=0;o<t.length;o++)h.putInt16(t.charCodeAt(o));h.putInt16(0)}var l=h.length(),d=e.length(),p=new T.util.ByteBuffer;p.fillWithByte(r,f);var g=f*Math.ceil(d/f),v=new T.util.ByteBuffer;for(o=0;o<g;o++)v.putByte(e.at(o%d));var b=f*Math.ceil(l/f),B=new T.util.ByteBuffer;for(o=0;o<b;o++)B.putByte(h.at(o%l));var A=v;A.putBuffer(B);for(var N=Math.ceil(i/c),I=1;I<=N;I++){var _=new T.util.ByteBuffer;_.putBytes(p.bytes()),_.putBytes(A.bytes());for(var O=0;O<n;O++)a.start(),a.update(_.getBytes()),_=a.digest();var W=new T.util.ByteBuffer;for(o=0;o<f;o++)W.putByte(_.at(o%c));var xt=Math.ceil(d/f)+Math.ceil(l/f),Ot=new T.util.ByteBuffer;for(s=0;s<xt;s++){var _t=new T.util.ByteBuffer(A.getBytes(f)),wt=511;for(o=W.length()-1;o>=0;o--)wt=wt>>8,wt+=W.at(o)+_t.at(o),_t.setAt(o,wt&255);Ot.putBuffer(_t)}A=Ot,u.putBuffer(_)}return u.truncate(u.length()-i),u};K.pbe.getCipher=function(t,e,r){switch(t){case K.oids.pkcs5PBES2:return K.pbe.getCipherForPBES2(t,e,r);case K.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case K.oids["pbewithSHAAnd40BitRC2-CBC"]:return K.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};K.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!m.validate(e,$u,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}if(t=m.derToOid(n.kdfOid),t!==K.oids.pkcs5PBKDF2){var a=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw a.oid=t,a.supportedOids=["pkcs5PBKDF2"],a}if(t=m.derToOid(n.encOid),t!==K.oids["aes128-CBC"]&&t!==K.oids["aes192-CBC"]&&t!==K.oids["aes256-CBC"]&&t!==K.oids["des-EDE3-CBC"]&&t!==K.oids.desCBC){var a=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw a.oid=t,a.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],a}var s=n.kdfSalt,o=T.util.createBuffer(n.kdfIterationCount);o=o.getInt(o.length()<<3);var c,f;switch(K.oids[t]){case"aes128-CBC":c=16,f=T.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,f=T.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,f=T.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,f=T.des.createDecryptionCipher;break;case"desCBC":c=8,f=T.des.createDecryptionCipher;break}var u=ko(n.prfOid),h=T.pkcs5.pbkdf2(r,s,o,c,u),l=n.encIv,d=f(h);return d.start(l),d};K.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!m.validate(e,Qu,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=T.util.createBuffer(n.salt),o=T.util.createBuffer(n.iterations);o=o.getInt(o.length()<<3);var c,f,u;switch(t){case K.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,f=8,u=T.des.startDecrypting;break;case K.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,f=8,u=function(g,v){var b=T.rc2.createDecryptionCipher(g,40);return b.start(v,null),b};break;default:var a=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw a.oid=t,a}var h=ko(n.prfOid),l=K.pbe.generatePkcs12Key(r,s,1,o,c,h);h.start();var d=K.pbe.generatePkcs12Key(r,s,2,o,f,h);return u(l,d)};K.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in T.md))throw new Error('"md5" hash algorithm unavailable.');n=T.md.md5.create()}e===null&&(e="");for(var i=[Ro(n,t+e)],a=16,s=1;a<r;++s,a+=16)i.push(Ro(n,i[s-1]+t+e));return i.join("").substr(0,r)};function Ro(t,e){return t.start().update(e).digest().getBytes()}function ko(t){var e;if(!t)e="hmacWithSHA1";else if(e=K.oids[m.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Do(e)}function Do(t){var e=T.md;switch(t){case"hmacWithSHA224":e=T.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function Xu(t,e,r,n){var i=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,!1,t),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,T.util.hexToBytes(r.toString(16))),m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OID,!1,m.oidToDer(K.oids[n]).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.NULL,!1,"")])),i}});var Ut=U((md,Ko)=>{"use strict";function Po(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function Ju(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return Po(t,r)}catch{r.message=t.message,r.stack=t.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),Po(new i,r)}}Ko.exports=Ju});var c0=U((Wy,f0)=>{var tt=X();Re();ht();var Dr=f0.exports=tt.sha512=tt.sha512||{};tt.md.sha512=tt.md.algorithms.sha512=Dr;var s0=tt.sha384=tt.sha512.sha384=tt.sha512.sha384||{};s0.create=function(){return Dr.create("SHA-384")};tt.md.sha384=tt.md.algorithms.sha384=s0;tt.sha512.sha256=tt.sha512.sha256||{create:function(){return Dr.create("SHA-512/256")}};tt.md["sha512/256"]=tt.md.algorithms["sha512/256"]=tt.sha512.sha256;tt.sha512.sha224=tt.sha512.sha224||{create:function(){return Dr.create("SHA-512/224")}};tt.md["sha512/224"]=tt.md.algorithms["sha512/224"]=tt.sha512.sha224;Dr.create=function(t){if(o0||ul(),typeof t>"u"&&(t="SHA-512"),!(t in Pe))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=Pe[t],r=null,n=tt.util.createBuffer(),i=new Array(80),a=0;a<80;++a)i[a]=new Array(2);var s=64;switch(t){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var o={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var c=o.messageLengthSize/4,f=0;f<c;++f)o.fullMessageLength.push(0);n=tt.util.createBuffer(),r=new Array(e.length);for(var f=0;f<e.length;++f)r[f]=e[f].slice(0);return o},o.start(),o.update=function(c,f){f==="utf8"&&(c=tt.util.encodeUtf8(c));var u=c.length;o.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=o.fullMessageLength.length-1;h>=0;--h)o.fullMessageLength[h]+=u[1],u[1]=u[0]+(o.fullMessageLength[h]/4294967296>>>0),o.fullMessageLength[h]=o.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(c),a0(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),o},o.digest=function(){var c=tt.util.createBuffer();c.putBytes(n.bytes());var f=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,u=f&o.blockLength-1;c.putBytes($i.substr(0,o.blockLength-u));for(var h,l,d=o.fullMessageLength[0]*8,p=0;p<o.fullMessageLength.length-1;++p)h=o.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,c.putInt32(d>>>0),d=h>>>0;c.putInt32(d);for(var g=new Array(r.length),p=0;p<r.length;++p)g[p]=r[p].slice(0);a0(g,i,c);var v=tt.util.createBuffer(),b;t==="SHA-512"?b=g.length:t==="SHA-384"?b=g.length-2:b=g.length-4;for(var p=0;p<b;++p)v.putInt32(g[p][0]),(p!==b-1||t!=="SHA-512/224")&&v.putInt32(g[p][1]);return v},o};var $i=null,o0=!1,Qi=null,Pe=null;function ul(){$i=String.fromCharCode(128),$i+=tt.util.fillString(String.fromCharCode(0),128),Qi=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Pe={},Pe["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Pe["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Pe["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Pe["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],o0=!0}function a0(t,e,r){for(var n,i,a,s,o,c,f,u,h,l,d,p,g,v,b,B,A,N,I,_,O,W,xt,Ot,_t,wt,Me,$r,ut,At,L,Un,Fn,On,Mn,Ca=r.length();Ca>=128;){for(ut=0;ut<16;++ut)e[ut][0]=r.getInt32()>>>0,e[ut][1]=r.getInt32()>>>0;for(;ut<80;++ut)Un=e[ut-2],At=Un[0],L=Un[1],n=((At>>>19|L<<13)^(L>>>29|At<<3)^At>>>6)>>>0,i=((At<<13|L>>>19)^(L<<3|At>>>29)^(At<<26|L>>>6))>>>0,On=e[ut-15],At=On[0],L=On[1],a=((At>>>1|L<<31)^(At>>>8|L<<24)^At>>>7)>>>0,s=((At<<31|L>>>1)^(At<<24|L>>>8)^(At<<25|L>>>7))>>>0,Fn=e[ut-7],Mn=e[ut-16],L=i+Fn[1]+s+Mn[1],e[ut][0]=n+Fn[0]+a+Mn[0]+(L/4294967296>>>0)>>>0,e[ut][1]=L>>>0;for(g=t[0][0],v=t[0][1],b=t[1][0],B=t[1][1],A=t[2][0],N=t[2][1],I=t[3][0],_=t[3][1],O=t[4][0],W=t[4][1],xt=t[5][0],Ot=t[5][1],_t=t[6][0],wt=t[6][1],Me=t[7][0],$r=t[7][1],ut=0;ut<80;++ut)f=((O>>>14|W<<18)^(O>>>18|W<<14)^(W>>>9|O<<23))>>>0,u=((O<<18|W>>>14)^(O<<14|W>>>18)^(W<<23|O>>>9))>>>0,h=(_t^O&(xt^_t))>>>0,l=(wt^W&(Ot^wt))>>>0,o=((g>>>28|v<<4)^(v>>>2|g<<30)^(v>>>7|g<<25))>>>0,c=((g<<4|v>>>28)^(v<<30|g>>>2)^(v<<25|g>>>7))>>>0,d=(g&b|A&(g^b))>>>0,p=(v&B|N&(v^B))>>>0,L=$r+u+l+Qi[ut][1]+e[ut][1],n=Me+f+h+Qi[ut][0]+e[ut][0]+(L/4294967296>>>0)>>>0,i=L>>>0,L=c+p,a=o+d+(L/4294967296>>>0)>>>0,s=L>>>0,Me=_t,$r=wt,_t=xt,wt=Ot,xt=O,Ot=W,L=_+i,O=I+n+(L/4294967296>>>0)>>>0,W=L>>>0,I=A,_=N,A=b,N=B,b=g,B=v,L=i+s,g=n+a+(L/4294967296>>>0)>>>0,v=L>>>0;L=t[0][1]+v,t[0][0]=t[0][0]+g+(L/4294967296>>>0)>>>0,t[0][1]=L>>>0,L=t[1][1]+B,t[1][0]=t[1][0]+b+(L/4294967296>>>0)>>>0,t[1][1]=L>>>0,L=t[2][1]+N,t[2][0]=t[2][0]+A+(L/4294967296>>>0)>>>0,t[2][1]=L>>>0,L=t[3][1]+_,t[3][0]=t[3][0]+I+(L/4294967296>>>0)>>>0,t[3][1]=L>>>0,L=t[4][1]+W,t[4][0]=t[4][0]+O+(L/4294967296>>>0)>>>0,t[4][1]=L>>>0,L=t[5][1]+Ot,t[5][0]=t[5][0]+xt+(L/4294967296>>>0)>>>0,t[5][1]=L>>>0,L=t[6][1]+wt,t[6][0]=t[6][0]+_t+(L/4294967296>>>0)>>>0,t[6][1]=L>>>0,L=t[7][1]+$r,t[7][0]=t[7][0]+Me+(L/4294967296>>>0)>>>0,t[7][1]=L>>>0,Ca-=128}}});var xp={};vt(xp,{createEd25519PeerId:()=>hp,createFromJSON:()=>gp,createFromPrivKey:()=>Yr,createFromProtobuf:()=>yp,createFromPubKey:()=>cf,createRSAPeerId:()=>pp,createSecp256k1PeerId:()=>lp,exportToProtobuf:()=>dp});var jn=Z(Gn(),1),ds=Z(ss(),1),ti=Z(Jn(),1),ys=Z(ps(),1),gs=Z(Te(),1);function Af(){gs.default._configure(),jn.default._configure(ds.default),ti.default._configure(ys.default)}Af();var xs=["uint64","int64","sint64","fixed64","sfixed64"];function Cf(t){for(let e of xs){if(t[e]==null)continue;let r=t[e];t[e]=function(){return BigInt(r.call(this).toString())}}return t}function ei(t){return Cf(new jn.default(t))}function Tf(t){for(let e of xs){if(t[e]==null)continue;let r=t[e];t[e]=function(n){return r.call(this,n.toString())}}return t}function ri(){return Tf(ti.default.create())}function qe(t,e){let r=ei(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}function ze(t,e){let r=ri();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var He;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(He||(He={}));function en(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function ni(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(a,s){let o=e(a);s.int32(o)},n=function(a){let s=a.int32();return e(s)};return en("enum",He.VARINT,r,n)}function Ge(t,e){return en("message",He.LENGTH_DELIMITED,t,e)}var rt;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(rt||(rt={}));var ii;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(ii||(ii={}));(function(t){t.codec=()=>ni(ii)})(rt||(rt={}));var Yt;(function(t){let e;t.codec=()=>(e==null&&(e=Ge((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),rt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},a=n==null?r.len:r.pos+n;for(;r.pos<a;){let s=r.uint32();switch(s>>>3){case 1:i.Type=rt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>ze(r,t.codec()),t.decode=r=>qe(r,t.codec())})(Yt||(Yt={}));var $t;(function(t){let e;t.codec=()=>(e==null&&(e=Ge((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),rt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},a=n==null?r.len:r.pos+n;for(;r.pos<a;){let s=r.uint32();switch(s>>>3){case 1:i.Type=rt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>ze(r,t.codec()),t.decode=r=>qe(r,t.codec())})($t||($t={}));var _1=Z(Ar(),1),R1=Z(Lo(),1),sp=Z(X(),1),ef=Z(Ut(),1);var ki={};vt(ki,{identity:()=>ih});function ju(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var a=t.charAt(i),s=a.charCodeAt(0);if(r[s]!==255)throw new TypeError(a+" is ambiguous");r[s]=i}var o=t.length,c=t.charAt(0),f=Math.log(o)/Math.log(256),u=Math.log(256)/Math.log(o);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,v=0,b=0,B=p.length;b!==B&&p[b]===0;)b++,g++;for(var A=(B-b)*u+1>>>0,N=new Uint8Array(A);b!==B;){for(var I=p[b],_=0,O=A-1;(I!==0||_<v)&&O!==-1;O--,_++)I+=256*N[O]>>>0,N[O]=I%o>>>0,I=I/o>>>0;if(I!==0)throw new Error("Non-zero carry");v=_,b++}for(var W=A-v;W!==A&&N[W]===0;)W++;for(var xt=c.repeat(g);W<A;++W)xt+=t.charAt(N[W]);return xt}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var v=0,b=0;p[g]===c;)v++,g++;for(var B=(p.length-g)*f+1>>>0,A=new Uint8Array(B);p[g];){var N=r[p.charCodeAt(g)];if(N===255)return;for(var I=0,_=B-1;(N!==0||I<b)&&_!==-1;_--,I++)N+=o*A[_]>>>0,A[_]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");b=I,g++}if(p[g]!==" "){for(var O=B-b;O!==B&&A[O]===0;)O++;for(var W=new Uint8Array(v+(B-O)),xt=v;O!==B;)W[xt++]=A[O++];return W}}}function d(p){var g=l(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var th=ju,eh=th,Uo=eh;var wd=new Uint8Array(0);var Fo=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},fe=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var Oo=t=>new TextEncoder().encode(t),Mo=t=>new TextDecoder().decode(t);var Ti=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Ii=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return qo(this,e)}},_i=class{constructor(e){this.decoders=e}or(e){return qo(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},qo=(t,e)=>new _i({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Ri=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Ti(e,r,n),this.decoder=new Ii(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Xe=({name:t,prefix:e,encode:r,decode:n})=>new Ri(t,e,r,n),ve=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=Uo(r,e);return Xe({prefix:t,name:e,encode:n,decode:a=>fe(i(a))})},rh=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let a=t.length;for(;t[a-1]==="=";)--a;let s=new Uint8Array(a*r/8|0),o=0,c=0,f=0;for(let u=0;u<a;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,o+=r,o>=8&&(o-=8,s[f++]=255&c>>o)}if(o>=r||255&c<<8-o)throw new SyntaxError("Unexpected end of data");return s},nh=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,a="",s=0,o=0;for(let c=0;c<t.length;++c)for(o=o<<8|t[c],s+=8;s>r;)s-=r,a+=e[i&o>>s];if(s&&(a+=e[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a},ft=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Xe({prefix:e,name:t,encode(i){return nh(i,n,r)},decode(i){return rh(i,n,r,t)}});var ih=Xe({prefix:"\0",name:"identity",encode:t=>Mo(t),decode:t=>Oo(t)});var Di={};vt(Di,{base2:()=>ah});var ah=ft({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ni={};vt(Ni,{base8:()=>sh});var sh=ft({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Li={};vt(Li,{base10:()=>oh});var oh=ve({prefix:"9",name:"base10",alphabet:"0123456789"});var Pi={};vt(Pi,{base16:()=>fh,base16upper:()=>ch});var fh=ft({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ch=ft({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ki={};vt(Ki,{base32:()=>Je,base32hex:()=>ph,base32hexpad:()=>yh,base32hexpadupper:()=>gh,base32hexupper:()=>dh,base32pad:()=>hh,base32padupper:()=>lh,base32upper:()=>uh,base32z:()=>xh});var Je=ft({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),uh=ft({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),hh=ft({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),lh=ft({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ph=ft({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),dh=ft({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),yh=ft({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),gh=ft({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),xh=ft({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ui={};vt(Ui,{base36:()=>vh,base36upper:()=>mh});var vh=ve({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),mh=ve({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Fi={};vt(Fi,{base58btc:()=>Bt,base58flickr:()=>bh});var Bt=ve({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),bh=ve({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Oi={};vt(Oi,{base64:()=>wn,base64pad:()=>wh,base64url:()=>Sh,base64urlpad:()=>Eh});var wn=ft({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),wh=ft({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Sh=ft({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Eh=ft({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Mi={};vt(Mi,{base256emoji:()=>Ih});var zo=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Bh=zo.reduce((t,e,r)=>(t[r]=e,t),[]),Ah=zo.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Ch(t){return t.reduce((e,r)=>(e+=Bh[r],e),"")}function Th(t){let e=[];for(let r of t){let n=Ah[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Ih=Xe({prefix:"\u{1F680}",name:"base256emoji",encode:Ch,decode:Th});var Hi={};vt(Hi,{sha256:()=>mt,sha512:()=>Zh});var _h=Wo,Ho=128,Rh=127,kh=~Rh,Dh=Math.pow(2,31);function Wo(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Dh;)e[r++]=t&255|Ho,t/=128;for(;t&kh;)e[r++]=t&255|Ho,t>>>=7;return e[r]=t|0,Wo.bytes=r-n+1,e}var Nh=Vi,Lh=128,Go=127;function Vi(t,n){var r=0,n=n||0,i=0,a=n,s,o=t.length;do{if(a>=o)throw Vi.bytes=0,new RangeError("Could not decode varint");s=t[a++],r+=i<28?(s&Go)<<i:(s&Go)*Math.pow(2,i),i+=7}while(s>=Lh);return Vi.bytes=a-n,r}var Ph=Math.pow(2,7),Kh=Math.pow(2,14),Uh=Math.pow(2,21),Fh=Math.pow(2,28),Oh=Math.pow(2,35),Mh=Math.pow(2,42),Vh=Math.pow(2,49),qh=Math.pow(2,56),zh=Math.pow(2,63),Hh=function(t){return t<Ph?1:t<Kh?2:t<Uh?3:t<Fh?4:t<Oh?5:t<Mh?6:t<Vh?7:t<qh?8:t<zh?9:10},Gh={encode:_h,decode:Nh,encodingLength:Hh},Wh=Gh,Ir=Wh;var _r=(t,e=0)=>[Ir.decode(t,e),Ir.decode.bytes],je=(t,e,r=0)=>(Ir.encode(t,e,r),e),tr=t=>Ir.encodingLength(t);var re=(t,e)=>{let r=e.byteLength,n=tr(t),i=n+tr(r),a=new Uint8Array(i+r);return je(t,a,0),je(r,a,n),a.set(e,i),new er(t,r,e,a)},Rr=t=>{let e=fe(t),[r,n]=_r(e),[i,a]=_r(e.subarray(n)),s=e.subarray(n+a);if(s.byteLength!==i)throw new Error("Incorrect length");return new er(r,i,s,e)},Zo=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&Fo(t.bytes,r.bytes)}},er=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var zi=({name:t,code:e,encode:r})=>new qi(t,e,r),qi=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?re(this.code,r):r.then(n=>re(this.code,n))}else throw Error("Unknown type, must be binary type")}};var $o=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),mt=zi({name:"sha2-256",code:18,encode:$o("SHA-256")}),Zh=zi({name:"sha2-512",code:19,encode:$o("SHA-512")});var Gi={};vt(Gi,{identity:()=>me});var Qo=0,Yh="identity",Xo=fe,$h=t=>re(Qo,Xo(t)),me={code:Qo,name:Yh,encode:Xo,digest:$h};var qd=new TextEncoder,zd=new TextDecoder;var Jh=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return tl(r,Wi(t),e||Bt.encoder);default:return el(r,Wi(t),e||Je.encoder)}},Jo=new WeakMap,Wi=t=>{let e=Jo.get(t);if(e==null){let r=new Map;return Jo.set(t,r),r}return e},st=class{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==kr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==rl)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return st.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=re(e,r);return st.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return st.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&Zo(e.multihash,n.multihash)}toString(e){return Jh(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof st)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:a,bytes:s}=r;return new st(n,i,a,s||jo(n,i,a.bytes))}else if(r[nl]===!0){let{version:n,multihash:i,code:a}=r,s=Rr(i);return st.create(n,a,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==kr)throw new Error(`Version 0 CID must use dag-pb (code: ${kr}) block encoding`);return new st(e,r,n,n.bytes)}case 1:{let i=jo(e,r,n.bytes);return new st(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return st.create(0,kr,e)}static createV1(e,r){return st.create(1,e,r)}static decode(e){let[r,n]=st.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=st.inspectBytes(e),n=r.size-r.multihashSize,i=fe(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let a=i.subarray(r.multihashSize-r.digestSize),s=new er(r.multihashCode,r.digestSize,a,i);return[r.version===0?st.createV0(s):st.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=_r(e.subarray(r));return r+=l,h},i=n(),a=kr;if(i===18?(i=0,r=0):a=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,o=n(),c=n(),f=r+c,u=f-s;return{version:i,codec:a,multihashCode:o,digestSize:c,multihashSize:u,size:f}}static parse(e,r){let[n,i]=jh(e,r),a=st.decode(i);return Wi(a).set(n,e),a}},jh=(t,e)=>{switch(t[0]){case"Q":{let r=e||Bt;return[Bt.prefix,r.decode(`${Bt.prefix}${t}`)]}case Bt.prefix:{let r=e||Bt;return[Bt.prefix,r.decode(t)]}case Je.prefix:{let r=e||Je;return[Je.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},tl=(t,e,r)=>{let{prefix:n}=r;if(n!==Bt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let a=r.encode(t).slice(1);return e.set(n,a),a}else return i},el=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let a=r.encode(t);return e.set(n,a),a}else return i},kr=112,rl=18,jo=(t,e,r)=>{let n=tr(t),i=n+tr(e),a=new Uint8Array(i+r.byteLength);return je(t,a,0),je(e,a,n),a.set(r,i),a},nl=Symbol.for("@ipld/js-cid/CID");var nr={...ki,...Di,...Ni,...Li,...Pi,...Ki,...Ui,...Fi,...Oi,...Mi},jd={...Hi,...Gi};function ir(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function En(t=0){return globalThis.Buffer?.allocUnsafe!=null?ir(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function e0(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var t0=e0("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Zi=e0("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=En(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),il={utf8:t0,"utf-8":t0,hex:nr.base16,latin1:Zi,ascii:Zi,binary:Zi,...nr},Bn=il;function bt(t,e="utf8"){let r=Bn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ir(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var sl=Z(Ut(),1);function Le(t,e){e==null&&(e=t.reduce((i,a)=>i+a.length,0));let r=En(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return ir(r)}var Tt={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var ol=Z(Ut(),1);var By=Z(ht(),1),Ay=Z(xn(),1),r0=Z(X(),1);function Rt(t,e="utf8"){let r=Bn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function Ht(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Le([new Uint8Array(e-r.length),r])}return Rt(r,"base64url")}function kt(t){let e=n0(t);return new r0.default.jsbn.BigInteger(Rt(e,"base16"),16)}function n0(t,e){let r=bt(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Le([new Uint8Array(e-r.length),r])}return r}function Dt(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var fl={"P-256":256,"P-384":384,"P-521":521},cl=Object.keys(fl),Ky=cl.join(" / ");function Yi(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",a=t?.saltLength??16,s=t?.iterations??32767,o=Tt.get();r*=8;async function c(h,l){let d=o.getRandomValues(new Uint8Array(a)),p=o.getRandomValues(new Uint8Array(n)),g={name:e,iv:p};typeof l=="string"&&(l=bt(l));let v={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},b=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),B=await o.subtle.deriveKey(v,b,{name:e,length:r},!0,["encrypt"]),A=await o.subtle.encrypt(g,B,h);return Le([d,g.iv,new Uint8Array(A)])}async function f(h,l){let d=h.subarray(0,a),p=h.subarray(a,a+n),g=h.subarray(a+n),v={name:e,iv:p};typeof l=="string"&&(l=bt(l));let b={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},B=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),A=await o.subtle.deriveKey(b,B,{name:e,length:r},!0,["decrypt"]),N=await o.subtle.decrypt(v,A,g);return new Uint8Array(N)}return{encrypt:c,decrypt:f}}var sa={};vt(sa,{RsaPrivateKey:()=>lr,RsaPublicKey:()=>Fr,fromJwk:()=>Ll,generateKeyPair:()=>Pl,unmarshalRsaPrivateKey:()=>Dl,unmarshalRsaPublicKey:()=>Nl});var aa=Z(Ut(),1);var p1=Z(c0(),1),Ur=Z(X(),1);var hl=Z(Ye(),1);var V=BigInt(0),et=BigInt(1),be=BigInt(2),Lr=BigInt(3),ll=BigInt(8),it=Object.freeze({a:V,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:et,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")});function u0(t){let{a:e,b:r}=it,n=R(t*t),i=R(n*t);return R(i+e*t+r)}var An=it.a===V,Tn=class extends Error{constructor(e){super(e)}},Y=class{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof Q))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new Y(e.x,e.y,et)}static toAffineBatch(e){let r=xl(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return Y.toAffineBatch(e).map(Y.fromAffine)}equals(e){if(!(e instanceof Y))throw new TypeError("JacobianPoint expected");let{x:r,y:n,z:i}=this,{x:a,y:s,z:o}=e,c=R(i*i),f=R(o*o),u=R(r*f),h=R(a*c),l=R(R(n*o)*f),d=R(R(s*i)*c);return u===h&&l===d}negate(){return new Y(this.x,R(-this.y),this.z)}double(){let{x:e,y:r,z:n}=this,i=R(e*e),a=R(r*r),s=R(a*a),o=e+a,c=R(be*(R(o*o)-i-s)),f=R(Lr*i),u=R(f*f),h=R(u-be*c),l=R(f*(c-h)-ll*s),d=R(be*r*n);return new Y(h,l,d)}add(e){if(!(e instanceof Y))throw new TypeError("JacobianPoint expected");let{x:r,y:n,z:i}=this,{x:a,y:s,z:o}=e;if(a===V||s===V)return this;if(r===V||n===V)return e;let c=R(i*i),f=R(o*o),u=R(r*f),h=R(a*c),l=R(R(n*o)*f),d=R(R(s*i)*c),p=R(h-u),g=R(d-l);if(p===V)return g===V?this.double():Y.ZERO;let v=R(p*p),b=R(p*v),B=R(u*v),A=R(g*g-b-be*B),N=R(g*(B-A)-l*b),I=R(i*o*p);return new Y(A,N,I)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=Y.ZERO;if(typeof e=="bigint"&&e===V)return r;let n=p0(e);if(n===et)return this;if(!An){let h=r,l=this;for(;n>V;)n&et&&(h=h.add(l)),l=l.double(),n>>=et;return h}let{k1neg:i,k1:a,k2neg:s,k2:o}=y0(n),c=r,f=r,u=this;for(;a>V||o>V;)a&et&&(c=c.add(u)),o&et&&(f=f.add(u)),u=u.double(),a>>=et,o>>=et;return i&&(c=c.negate()),s&&(f=f.negate()),f=new Y(R(f.x*it.beta),f.y,f.z),c.add(f)}precomputeWindow(e){let r=An?128/e+1:256/e+1,n=[],i=this,a=i;for(let s=0;s<r;s++){a=i,n.push(a);for(let o=1;o<2**(e-1);o++)a=a.add(i),n.push(a);i=a.double()}return n}wNAF(e,r){!r&&this.equals(Y.BASE)&&(r=Q.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Ji.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=Y.normalizeZ(i),Ji.set(r,i)));let a=Y.ZERO,s=Y.ZERO,o=1+(An?128/n:256/n),c=2**(n-1),f=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<o;l++){let d=l*c,p=Number(e&f);if(e>>=h,p>c&&(p-=u,e+=et),p===0){let g=i[d];l%2&&(g=g.negate()),s=s.add(g)}else{let g=i[d+Math.abs(p)-1];p<0&&(g=g.negate()),a=a.add(g)}}return{p:a,f:s}}multiply(e,r){let n=p0(e),i,a;if(An){let{k1neg:s,k1:o,k2neg:c,k2:f}=y0(n),{p:u,f:h}=this.wNAF(o,r),{p:l,f:d}=this.wNAF(f,r);s&&(u=u.negate()),c&&(l=l.negate()),l=new Y(R(l.x*it.beta),l.y,l.z),i=u.add(l),a=h.add(d)}else{let{p:s,f:o}=this.wNAF(n,r);i=s,a=o}return Y.normalizeZ([i,a])[0]}toAffine(e=ur(this.z)){let{x:r,y:n,z:i}=this,a=e,s=R(a*a),o=R(s*a),c=R(r*s),f=R(n*o);if(R(i*a)!==et)throw new Error("invZ was invalid");return new Q(c,f)}};Y.BASE=new Y(it.Gx,it.Gy,et);Y.ZERO=new Y(V,et,V);var Ji=new WeakMap,Q=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Ji.delete(this)}hasEvenY(){return this.y%be===V}static fromCompressedHex(e){let r=e.length===32,n=ce(r?e:e.subarray(1));if(!Xi(n))throw new Error("Point is not on curve");let i=u0(n),a=gl(i),s=(a&et)===et;r?s&&(a=R(-a)):(e[0]&1)===1!==s&&(a=R(-a));let o=new Q(n,a);return o.assertValidity(),o}static fromUncompressedHex(e){let r=ce(e.subarray(1,33)),n=ce(e.subarray(33,65)),i=new Q(r,n);return i.assertValidity(),i}static fromHex(e){let r=cr(e),n=r.length,i=r[0];if(n===32||n===33&&(i===2||i===3))return this.fromCompressedHex(r);if(n===65&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return Q.BASE.multiply(_n(e))}static fromSignature(e,r,n){e=cr(e);let i=g0(e),{r:a,s}=x0(r);if(n!==0&&n!==1)throw new Error("Cannot recover signature: invalid recovery bit");let o=n&1?"03":"02",c=Q.fromHex(o+sr(a)),{n:f}=it,u=ur(a,f),h=R(-i*u,f),l=R(s*u,f),d=Q.BASE.multiplyAndAddUnsafe(c,h,l);if(!d)throw new Error("Cannot recover signature: point at infinify");return d.assertValidity(),d}toRawBytes(e=!1){return Ke(this.toHex(e))}toHex(e=!1){let r=sr(this.x);return e?`${this.hasEvenY()?"02":"03"}${r}`:`04${r}${sr(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:r,y:n}=this;if(!Xi(r)||!Xi(n))throw new Error(e);let i=R(n*n),a=u0(r);if(R(i-a)!==V)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Q(this.x,R(-this.y))}double(){return Y.fromAffine(this).double().toAffine()}add(e){return Y.fromAffine(this).add(Y.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Y.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,r,n){let i=Y.fromAffine(this),a=r===V||r===et||this!==Q.BASE?i.multiplyUnsafe(r):i.multiply(r),s=Y.fromAffine(e).multiplyUnsafe(n),o=a.add(s);return o.equals(Y.ZERO)?void 0:o.toAffine()}};Q.BASE=new Q(it.Gx,it.Gy);Q.ZERO=new Q(V,V);function h0(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function l0(t){if(t.length<2||t[0]!==2)throw new Error(`Invalid signature integer tag: ${fr(t)}`);let e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:ce(r),left:t.subarray(e+2)}}function pl(t){if(t.length<2||t[0]!=48)throw new Error(`Invalid signature tag: ${fr(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=l0(t.subarray(2)),{data:n,left:i}=l0(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${fr(i)}`);return{r:e,s:n}}var ne=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=e instanceof Uint8Array,n="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?fr(e):e;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new ne(In(i.slice(0,64)),In(i.slice(64,128)))}static fromDER(e){let r=e instanceof Uint8Array;if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=pl(r?e:Ke(e));return new ne(n,i)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!Kr(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Kr(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=it.n>>et;return this.s>e}normalizeS(){return this.hasHighS()?new ne(this.r,it.n-this.s):this}toDERRawBytes(e=!1){return Ke(this.toDERHex(e))}toDERHex(e=!1){let r=h0(Nr(this.s));if(e)return r;let n=h0(Nr(this.r)),i=Nr(n.length/2),a=Nr(r.length/2);return`30${Nr(n.length/2+r.length/2+4)}02${i}${n}02${a}${r}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return Ke(this.toCompactHex())}toCompactHex(){return sr(this.r)+sr(this.s)}};function ar(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let a=t[n];r.set(a,i),i+=a.length}return r}var dl=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function fr(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let r=0;r<t.length;r++)e+=dl[t[r]];return e}var yl=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function sr(t){if(typeof t!="bigint")throw new Error("Expected bigint");if(!(V<=t&&t<yl))throw new Error("Expected number < 2^256");return t.toString(16).padStart(64,"0")}function ji(t){let e=Ke(sr(t));if(e.length!==32)throw new Error("Error: expected 32 bytes");return e}function Nr(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function In(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function Ke(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),a=Number.parseInt(i,16);if(Number.isNaN(a)||a<0)throw new Error("Invalid byte sequence");e[r]=a}return e}function ce(t){return In(fr(t))}function cr(t){return t instanceof Uint8Array?Uint8Array.from(t):Ke(t)}function p0(t){if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if(typeof t=="bigint"&&Kr(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function R(t,e=it.P){let r=t%e;return r>=V?r:e+r}function Ft(t,e){let{P:r}=it,n=t;for(;e-- >V;)n*=n,n%=r;return n}function gl(t){let{P:e}=it,r=BigInt(6),n=BigInt(11),i=BigInt(22),a=BigInt(23),s=BigInt(44),o=BigInt(88),c=t*t*t%e,f=c*c*t%e,u=Ft(f,Lr)*f%e,h=Ft(u,Lr)*f%e,l=Ft(h,be)*c%e,d=Ft(l,n)*l%e,p=Ft(d,i)*d%e,g=Ft(p,s)*p%e,v=Ft(g,o)*g%e,b=Ft(v,s)*p%e,B=Ft(b,Lr)*f%e,A=Ft(B,a)*d%e,N=Ft(A,r)*c%e;return Ft(N,be)}function ur(t,e=it.P){if(t===V||e<=V)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=R(t,e),n=e,i=V,a=et,s=et,o=V;for(;r!==V;){let f=n/r,u=n%r,h=i-s*f,l=a-o*f;n=r,r=u,i=s,a=o,s=h,o=l}if(n!==et)throw new Error("invert: does not exist");return R(i,e)}function xl(t,e=it.P){let r=new Array(t.length),n=t.reduce((a,s,o)=>s===V?a:(r[o]=a,R(a*s,e)),et),i=ur(n,e);return t.reduceRight((a,s,o)=>s===V?a:(r[o]=R(a*r[o],e),R(a*s,e)),i),r}var d0=(t,e)=>(t+e/be)/e,vl={a1:BigInt("0x3086d221a7d46bcde86c90e49284eb15"),b1:-et*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),a2:BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),b2:BigInt("0x3086d221a7d46bcde86c90e49284eb15"),POW_2_128:BigInt("0x100000000000000000000000000000000")};function y0(t){let{n:e}=it,{a1:r,b1:n,a2:i,b2:a,POW_2_128:s}=vl,o=d0(a*t,e),c=d0(-n*t,e),f=R(t-o*r-c*i,e),u=R(-o*n-c*a,e),h=f>s,l=u>s;if(h&&(f=e-f),l&&(u=e-u),f>s||u>s)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:h,k1:f,k2neg:l,k2:u}}function g0(t){let{n:e}=it,n=t.length*8-256,i=ce(t);return n>0&&(i=i>>BigInt(n)),i>=e&&(i-=e),i}var or,Pr,ta=class{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...e){return Gt.hmacSha256(this.k,...e)}hmacSync(...e){return Pr(this.k,...e)}checkSync(){if(typeof Pr!="function")throw new Tn("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.checkSync(),this.incr(),this.v=this.hmacSync(this.v),this.v}};function Kr(t){return V<t&&t<it.n}function Xi(t){return V<t&&t<it.P}function ml(t,e,r){let n=ce(t);if(!Kr(n))return;let{n:i}=it,a=Q.BASE.multiply(n),s=R(a.x,i);if(s===V)return;let o=R(ur(n,i)*R(e+r*s,i),i);if(o===V)return;let c=new ne(s,o),f=(a.x===c.r?0:2)|Number(a.y&et);return{sig:c,recovery:f}}function _n(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==64)throw new Error("Expected 32 bytes of private key");e=In(t)}else if(t instanceof Uint8Array){if(t.length!==32)throw new Error("Expected 32 bytes of private key");e=ce(t)}else throw new TypeError("Expected valid private key");if(!Kr(e))throw new Error("Expected private key: 0 < key < n");return e}function bl(t){return t instanceof Q?(t.assertValidity(),t):Q.fromHex(t)}function x0(t){if(t instanceof ne)return t.assertValidity(),t;try{return ne.fromDER(t)}catch{return ne.fromCompact(t)}}function ea(t,e=!1){return Q.fromPrivateKey(t).toRawBytes(e)}function v0(t){let e=t.length>32?t.slice(0,32):t;return ce(e)}function wl(t){let e=v0(t),r=R(e,it.n);return m0(r<V?e:r)}function m0(t){return ji(t)}function Sl(t,e,r){if(t==null)throw new Error(`sign: expected valid message hash, not "${t}"`);let n=cr(t),i=_n(e),a=[m0(i),wl(n)];if(r!=null){r===!0&&(r=Gt.randomBytes(32));let c=cr(r);if(c.length!==32)throw new Error("sign: Expected 32 bytes of extra data");a.push(c)}let s=ar(...a),o=v0(n);return{seed:s,m:o,d:i}}function El(t,e){let{sig:r,recovery:n}=t,{canonical:i,der:a,recovered:s}=Object.assign({canonical:!0,der:!0},e);i&&r.hasHighS()&&(r=r.normalizeS(),n^=1);let o=a?r.toDERRawBytes():r.toCompactRawBytes();return s?[o,n]:o}async function b0(t,e,r={}){let{seed:n,m:i,d:a}=Sl(t,e,r.extraEntropy),s,o=new ta;for(await o.reseed(n);!(s=ml(await o.generate(),i,a));)await o.reseed();return El(s,r)}var Bl={strict:!0};function w0(t,e,r,n=Bl){let i;try{i=x0(t),e=cr(e)}catch{return!1}let{r:a,s}=i;if(n.strict&&i.hasHighS())return!1;let o=g0(e),c;try{c=bl(r)}catch{return!1}let{n:f}=it,u=ur(s,f),h=R(o*u,f),l=R(a*u,f),d=Q.BASE.multiplyAndAddUnsafe(c,h,l);return d?R(d.x,f)===a:!1}Q.BASE._setWindowSize(8);var Nt={node:hl,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var Cn={},Gt={bytesToHex:fr,hexToBytes:Ke,concatBytes:ar,mod:R,invert:ur,isValidPrivateKey(t){try{return _n(t),!0}catch{return!1}},_bigintTo32Bytes:ji,_normalizePrivateKey:_n,hashToPrivateKey:t=>{if(t=cr(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let e=R(ce(t),it.n-et)+et;return ji(e)},randomBytes:(t=32)=>{if(Nt.web)return Nt.web.getRandomValues(new Uint8Array(t));if(Nt.node){let{randomBytes:e}=Nt.node;return Uint8Array.from(e(t))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Gt.hashToPrivateKey(Gt.randomBytes(40)),sha256:async(...t)=>{if(Nt.web){let e=await Nt.web.subtle.digest("SHA-256",ar(...t));return new Uint8Array(e)}else if(Nt.node){let{createHash:e}=Nt.node,r=e("sha256");return t.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(Nt.web){let r=await Nt.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=ar(...e),i=await Nt.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(Nt.node){let{createHmac:r}=Nt.node,n=r("sha256",t);return e.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(t,...e)=>{let r=Cn[t];if(r===void 0){let n=await Gt.sha256(Uint8Array.from(t,i=>i.charCodeAt(0)));r=ar(n,n),Cn[t]=r}return Gt.sha256(r,...e)},taggedHashSync:(t,...e)=>{if(typeof or!="function")throw new Tn("sha256Sync is undefined, you need to set it");let r=Cn[t];if(r===void 0){let n=or(Uint8Array.from(t,i=>i.charCodeAt(0)));r=ar(n,n),Cn[t]=r}return or(r,...e)},precompute(t=8,e=Q.BASE){let r=e===Q.BASE?e:new Q(e.x,e.y);return r._setWindowSize(t),r.multiply(Lr),r}};Object.defineProperties(Gt,{sha256Sync:{configurable:!1,get(){return or},set(t){or||(or=t)}},hmacSha256Sync:{configurable:!1,get(){return Pr},set(t){Pr||(Pr=t)}}});var S0=Z(Ut(),1);function Rn(t){if(isNaN(t)||t<=0)throw(0,S0.default)(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return Gt.randomBytes(t)}var Ue={};vt(Ue,{jwkToPkcs1:()=>Tl,jwkToPkix:()=>_l,pkcs1ToJwk:()=>Cl,pkixToJwk:()=>Il});var $y=Z(Ar(),1),Qy=Z(bn(),1),ue=Z(X(),1);var ra=Z(Ut(),1);function Cl(t){let e=ue.default.asn1.fromDer(Rt(t,"ascii")),r=ue.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Ht(r.n),e:Ht(r.e),d:Ht(r.d),p:Ht(r.p),q:Ht(r.q),dp:Ht(r.dP),dq:Ht(r.dQ),qi:Ht(r.qInv),alg:"RS256"}}function Tl(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw(0,ra.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let e=ue.default.pki.privateKeyToAsn1({n:kt(t.n),e:kt(t.e),d:kt(t.d),p:kt(t.p),q:kt(t.q),dP:kt(t.dp),dQ:kt(t.dq),qInv:kt(t.qi)});return bt(ue.default.asn1.toDer(e).getBytes(),"ascii")}function Il(t){let e=ue.default.asn1.fromDer(Rt(t,"ascii")),r=ue.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Ht(r.n),e:Ht(r.e)}}function _l(t){if(t.n==null||t.e==null)throw(0,ra.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let e=ue.default.pki.publicKeyToAsn1({n:kt(t.n),e:kt(t.e)});return bt(ue.default.asn1.toDer(e).getBytes(),"ascii")}var t1=Z(bn(),1),na=Z(X(),1);function E0(t,e){return e.map(r=>kt(t[r]))}function B0(t){return na.default.pki.setRsaPrivateKey(...E0(t,["n","e","d","p","q","dp","dq","qi"]))}function A0(t){return na.default.pki.setRsaPublicKey(...E0(t,["n","e"]))}var C0=Z(Ut(),1);async function T0(t){let e=await Tt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await R0(e);return{privateKey:r[0],publicKey:r[1]}}async function ia(t){let r=[await Tt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await Rl(t)],n=await R0({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function I0(t,e){let r=await Tt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Tt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function _0(t,e,r){let n=await Tt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await Tt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function R0(t){if(t.privateKey==null||t.publicKey==null)throw(0,C0.default)(new Error("Private and public key are required"),"ERR_INVALID_PARAMETERS");return await Promise.all([Tt.get().subtle.exportKey("jwk",t.privateKey),Tt.get().subtle.exportKey("jwk",t.publicKey)])}async function Rl(t){return await Tt.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function k0(t,e,r,n){let i=e?A0(t):B0(t),a=Rt(Uint8Array.from(r),"ascii"),s=n(a,i);return bt(s,"ascii")}function D0(t,e){return k0(t,!0,e,(r,n)=>n.encrypt(r))}function N0(t,e){return k0(t,!1,e,(r,n)=>n.decrypt(r))}async function hr(t,e){let n=await Yi().encrypt(t,e);return wn.encode(n)}var Fr=class{constructor(e){this._key=e}async verify(e,r){return await _0(this._key,r,e)}marshal(){return Ue.jwkToPkix(this._key)}get bytes(){return Yt.encode({Type:rt.RSA,Data:this.marshal()}).subarray()}encrypt(e){return D0(this._key,e)}equals(e){return Dt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await mt.digest(this.bytes);return e}},lr=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return Rn(16)}async sign(e){return await I0(this._key,e)}get public(){if(this._publicKey==null)throw(0,aa.default)(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new Fr(this._publicKey)}decrypt(e){return N0(this._key,e)}marshal(){return Ue.jwkToPkcs1(this._key)}get bytes(){return $t.encode({Type:rt.RSA,Data:this.marshal()}).subarray()}equals(e){return Dt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await mt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return Rt(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new Ur.default.util.ByteBuffer(this.marshal()),i=Ur.default.asn1.fromDer(n),a=Ur.default.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Ur.default.pki.encryptRsaPrivateKey(a,e,s)}else{if(r==="libp2p-key")return await hr(this.bytes,e);throw(0,aa.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function Dl(t){let e=Ue.pkcs1ToJwk(t),r=await ia(e);return new lr(r.privateKey,r.publicKey)}function Nl(t){let e=Ue.pkixToJwk(t);return new Fr(e)}async function Ll(t){let e=await ia(t);return new lr(e.privateKey,e.publicKey)}async function Pl(t){let e=await T0(t);return new lr(e.privateKey,e.publicKey)}var ga={};vt(ga,{Ed25519PrivateKey:()=>Oe,Ed25519PublicKey:()=>zr,generateKeyPair:()=>ep,generateKeyPairFromSeed:()=>Z0,unmarshalEd25519PrivateKey:()=>jl,unmarshalEd25519PublicKey:()=>tp});var ya=Z(Ut(),1);var Kl=Z(Ye(),1);var gt=BigInt(0),z=BigInt(1),pr=BigInt(2),L0=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),at=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:L0,n:L0,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")});var F0=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),Or=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),y1=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),Ul=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Fl=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Ol=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Ml=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),q=class{constructor(e,r,n,i){this.x=e,this.y=r,this.z=n,this.t=i}static fromAffine(e){if(!(e instanceof ot))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(ot.ZERO)?q.ZERO:new q(e.x,e.y,z,S(e.x*e.y))}static toAffineBatch(e){let r=zl(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){P0(e);let{x:r,y:n,z:i}=this,{x:a,y:s,z:o}=e,c=S(r*o),f=S(a*i),u=S(n*o),h=S(s*i);return c===f&&u===h}negate(){return new q(S(-this.x),this.y,this.z,S(-this.t))}double(){let{x:e,y:r,z:n}=this,{a:i}=at,a=S(e*e),s=S(r*r),o=S(pr*S(n*n)),c=S(i*a),f=e+r,u=S(S(f*f)-a-s),h=c+s,l=h-o,d=c-s,p=S(u*l),g=S(h*d),v=S(u*d),b=S(l*h);return new q(p,g,b,v)}add(e){P0(e);let{x:r,y:n,z:i,t:a}=this,{x:s,y:o,z:c,t:f}=e,u=S((n-r)*(o+s)),h=S((n+r)*(o-s)),l=S(h-u);if(l===gt)return this.double();let d=S(i*pr*f),p=S(a*pr*c),g=p+d,v=h+u,b=p-d,B=S(g*l),A=S(v*b),N=S(g*b),I=S(l*v);return new q(B,A,I,N)}subtract(e){return this.add(e.negate())}precomputeWindow(e){let r=1+256/e,n=[],i=this,a=i;for(let s=0;s<r;s++){a=i,n.push(a);for(let o=1;o<2**(e-1);o++)a=a.add(i),n.push(a);i=a.double()}return n}wNAF(e,r){!r&&this.equals(q.BASE)&&(r=ot.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&ha.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=q.normalizeZ(i),ha.set(r,i)));let a=q.ZERO,s=q.ZERO,o=1+256/n,c=2**(n-1),f=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<o;l++){let d=l*c,p=Number(e&f);if(e>>=h,p>c&&(p-=u,e+=z),p===0){let g=i[d];l%2&&(g=g.negate()),s=s.add(g)}else{let g=i[d+Math.abs(p)-1];p<0&&(g=g.negate()),a=a.add(g)}}return q.normalizeZ([a,s])[0]}multiply(e,r){return this.wNAF(Dn(e,at.l),r)}multiplyUnsafe(e){let r=Dn(e,at.l,!1),n=q.BASE,i=q.ZERO;if(r===gt)return i;if(this.equals(i)||r===z)return this;if(this.equals(n))return this.wNAF(r);let a=i,s=this;for(;r>gt;)r&z&&(a=a.add(s)),s=s.double(),r>>=z;return a}isSmallOrder(){return this.multiplyUnsafe(at.h).equals(q.ZERO)}isTorsionFree(){return this.multiplyUnsafe(at.l).equals(q.ZERO)}toAffine(e=Nn(this.z)){let{x:r,y:n,z:i}=this,a=S(r*e),s=S(n*e);if(S(i*e)!==z)throw new Error("invZ was invalid");return new ot(a,s)}fromRistrettoBytes(){fa()}toRistrettoBytes(){fa()}fromRistrettoHash(){fa()}};q.BASE=new q(at.Gx,at.Gy,z,S(at.Gx*at.Gy));q.ZERO=new q(gt,z,z,gt);function P0(t){if(!(t instanceof q))throw new TypeError("ExtendedPoint expected")}function oa(t){if(!(t instanceof It))throw new TypeError("RistrettoPoint expected")}function fa(){throw new Error("Legacy method: switch to RistrettoPoint")}var It=class{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){let{d:r}=at,n=S(Or*e*e),i=S((n+z)*Ol),a=BigInt(-1),s=S((a-r*n)*S(n+r)),{isValid:o,value:c}=pa(i,s),f=S(c*e);Se(f)||(f=S(-f)),o||(c=f),o||(a=n);let u=S(a*(n-z)*Ml-s),h=c*c,l=S((c+c)*s),d=S(u*Ul),p=S(z-h),g=S(z+h);return new q(S(l*g),S(p*d),S(d*g),S(l*p))}static hashToCurve(e){e=Ee(e,64);let r=ca(e.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=ca(e.slice(32,64)),a=this.calcElligatorRistrettoMap(i);return new It(n.add(a))}static fromHex(e){e=Ee(e,32);let{a:r,d:n}=at,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",a=ca(e);if(!Gl(Mr(a),e)||Se(a))throw new Error(i);let s=S(a*a),o=S(z+r*s),c=S(z-r*s),f=S(o*o),u=S(c*c),h=S(r*n*f-u),{isValid:l,value:d}=U0(S(h*u)),p=S(d*c),g=S(d*p*h),v=S((a+a)*p);Se(v)&&(v=S(-v));let b=S(o*g),B=S(v*b);if(!l||Se(B)||b===gt)throw new Error(i);return new It(new q(v,b,z,B))}toRawBytes(){let{x:e,y:r,z:n,t:i}=this.ep,a=S(S(n+r)*S(n-r)),s=S(e*r),o=S(s*s),{value:c}=U0(S(a*o)),f=S(c*a),u=S(c*s),h=S(f*u*i),l;if(Se(i*h)){let p=S(r*Or),g=S(e*Or);e=p,r=g,l=S(f*Fl)}else l=u;Se(e*h)&&(r=S(-r));let d=S((n-r)*l);return Se(d)&&(d=S(-d)),Mr(d)}toHex(){return Vr(this.toRawBytes())}toString(){return this.toHex()}equals(e){oa(e);let r=this.ep,n=e.ep,i=S(r.x*n.y)===S(r.y*n.x),a=S(r.y*n.y)===S(r.x*n.x);return i||a}add(e){return oa(e),new It(this.ep.add(e.ep))}subtract(e){return oa(e),new It(this.ep.subtract(e.ep))}multiply(e){return new It(this.ep.multiply(e))}multiplyUnsafe(e){return new It(this.ep.multiplyUnsafe(e))}};It.BASE=new It(q.BASE);It.ZERO=new It(q.ZERO);var ha=new WeakMap,ot=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,ha.delete(this)}static fromHex(e,r=!0){let{d:n,P:i}=at;e=Ee(e,32);let a=e.slice();a[31]=e[31]&-129;let s=qr(a);if(r&&s>=i)throw new Error("Expected 0 < hex < P");if(!r&&s>=F0)throw new Error("Expected 0 < hex < 2**256");let o=S(s*s),c=S(o-z),f=S(n*o+z),{isValid:u,value:h}=pa(c,f);if(!u)throw new Error("Point.fromHex: invalid y coordinate");let l=(h&z)===z;return(e[31]&128)!==0!==l&&(h=S(-h)),new ot(h,s)}static async fromPrivateKey(e){return(await Ln(e)).point}toRawBytes(){let e=Mr(this.y);return e[31]|=this.x&z?128:0,e}toHex(){return Vr(this.toRawBytes())}toX25519(){let{y:e}=this,r=S((z+e)*Nn(z-e));return Mr(r)}isTorsionFree(){return q.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new ot(S(-this.x),this.y)}add(e){return q.fromAffine(this).add(q.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return q.fromAffine(this).multiply(e,this).toAffine()}};ot.BASE=new ot(at.Gx,at.Gy);ot.ZERO=new ot(gt,z);var Fe=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromHex(e){let r=Ee(e,64),n=ot.fromHex(r.slice(0,32),!1),i=qr(r.slice(32,64));return new Fe(n,i)}assertValidity(){let{r:e,s:r}=this;if(!(e instanceof ot))throw new Error("Expected Point instance");return Dn(r,at.l,!1),this}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(Mr(this.s),32),e}toHex(){return Vr(this.toRawBytes())}};function K0(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let a=t[n];r.set(a,i),i+=a.length}return r}var Vl=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Vr(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=Vl[t[r]];return e}function la(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),a=Number.parseInt(i,16);if(Number.isNaN(a)||a<0)throw new Error("Invalid byte sequence");e[r]=a}return e}function O0(t){let r=t.toString(16).padStart(64,"0");return la(r)}function Mr(t){return O0(t).reverse()}function Se(t){return(S(t)&z)===z}function qr(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+Vr(Uint8Array.from(t).reverse()))}var ql=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function ca(t){return S(qr(t)&ql)}function S(t,e=at.P){let r=t%e;return r>=gt?r:e+r}function Nn(t,e=at.P){if(t===gt||e<=gt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=S(t,e),n=e,i=gt,a=z,s=z,o=gt;for(;r!==gt;){let f=n/r,u=n%r,h=i-s*f,l=a-o*f;n=r,r=u,i=s,a=o,s=h,o=l}if(n!==z)throw new Error("invert: does not exist");return S(i,e)}function zl(t,e=at.P){let r=new Array(t.length),n=t.reduce((a,s,o)=>s===gt?a:(r[o]=a,S(a*s,e)),z),i=Nn(n,e);return t.reduceRight((a,s,o)=>s===gt?a:(r[o]=S(a*r[o],e),S(a*s,e)),i),r}function ie(t,e){let{P:r}=at,n=t;for(;e-- >gt;)n*=n,n%=r;return n}function Hl(t){let{P:e}=at,r=BigInt(5),n=BigInt(10),i=BigInt(20),a=BigInt(40),s=BigInt(80),c=t*t%e*t%e,f=ie(c,pr)*c%e,u=ie(f,z)*t%e,h=ie(u,r)*u%e,l=ie(h,n)*h%e,d=ie(l,i)*l%e,p=ie(d,a)*d%e,g=ie(p,s)*p%e,v=ie(g,s)*p%e,b=ie(v,n)*h%e;return{pow_p_5_8:ie(b,pr)*t%e,b2:c}}function pa(t,e){let r=S(e*e*e),n=S(r*r*e),i=Hl(t*n).pow_p_5_8,a=S(t*r*i),s=S(e*a*a),o=a,c=S(a*Or),f=s===t,u=s===S(-t),h=s===S(-t*Or);return f&&(a=o),(u||h)&&(a=c),Se(a)&&(a=S(-a)),{isValid:f||u,value:a}}function U0(t){return pa(z,t)}function kn(t){return S(qr(t),at.l)}function Gl(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Ee(t,e){let r=t instanceof Uint8Array?Uint8Array.from(t):la(t);if(typeof e=="number"&&r.length!==e)throw new Error(`Expected ${e} bytes`);return r}function Dn(t,e,r=!0){if(!e)throw new TypeError("Specify max value");if(typeof t=="number"&&Number.isSafeInteger(t)&&(t=BigInt(t)),typeof t=="bigint"&&t<e){if(r){if(gt<t)return t}else if(gt<=t)return t}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function Wl(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Zl(t){if(t=typeof t=="bigint"||typeof t=="number"?O0(Dn(t,F0)):Ee(t),t.length!==32)throw new Error("Expected 32 bytes");return t}function Yl(t){let e=Wl(t.slice(0,32)),r=t.slice(32,64),n=kn(e),i=ot.BASE.multiply(n),a=i.toRawBytes();return{head:e,prefix:r,scalar:n,point:i,pointBytes:a}}var ua;async function Ln(t){return Yl(await Be.sha512(Zl(t)))}async function da(t){return(await Ln(t)).pointBytes}async function M0(t,e){t=Ee(t);let{prefix:r,scalar:n,pointBytes:i}=await Ln(e),a=kn(await Be.sha512(r,t)),s=ot.BASE.multiply(a),o=kn(await Be.sha512(s.toRawBytes(),i,t)),c=S(a+o*n,at.l);return new Fe(s,c).toRawBytes()}function $l(t,e,r){e=Ee(e),r instanceof ot||(r=ot.fromHex(r,!1));let{r:n,s:i}=t instanceof Fe?t.assertValidity():Fe.fromHex(t),a=q.BASE.multiplyUnsafe(i);return{r:n,s:i,SB:a,pub:r,msg:e}}function Ql(t,e,r,n){let i=kn(n),a=q.fromAffine(t).multiplyUnsafe(i);return q.fromAffine(e).add(a).subtract(r).multiplyUnsafe(at.h).equals(q.ZERO)}async function V0(t,e,r){let{r:n,SB:i,msg:a,pub:s}=$l(t,e,r),o=await Be.sha512(n.toRawBytes(),s.toRawBytes(),a);return Ql(s,n,i,o)}ot.BASE._setWindowSize(8);var we={node:Kl,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},Be={bytesToHex:Vr,hexToBytes:la,concatBytes:K0,getExtendedPublicKey:Ln,mod:S,invert:Nn,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:t=>{if(t=Ee(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return S(qr(t),at.l-z)+z},randomBytes:(t=32)=>{if(we.web)return we.web.getRandomValues(new Uint8Array(t));if(we.node){let{randomBytes:e}=we.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Be.randomBytes(32),sha512:async(...t)=>{let e=K0(...t);if(we.web){let r=await we.web.subtle.digest("SHA-512",e.buffer);return new Uint8Array(r)}else{if(we.node)return Uint8Array.from(we.node.createHash("sha512").update(e).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=ot.BASE){let r=e.equals(ot.BASE)?e:new ot(e.x,e.y);return r._setWindowSize(t),r.multiply(pr),r},sha512Sync:void 0};Object.defineProperties(Be,{sha512Sync:{configurable:!1,get(){return ua},set(t){ua||(ua=t)}}});var dr=32,he=64,Pn=32;async function q0(){let t=Be.randomPrivateKey(),e=await da(t);return{privateKey:W0(t,e),publicKey:e}}async function z0(t){if(t.length!==Pn)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await da(e);return{privateKey:W0(e,r),publicKey:r}}async function H0(t,e){let r=t.subarray(0,Pn);return await M0(e,r)}async function G0(t,e,r){return await V0(e,r,t)}function W0(t,e){let r=new Uint8Array(he);for(let n=0;n<Pn;n++)r[n]=t[n],r[Pn+n]=e[n];return r}var zr=class{constructor(e){this._key=yr(e,dr)}async verify(e,r){return await G0(this._key,r,e)}marshal(){return this._key}get bytes(){return Yt.encode({Type:rt.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Dt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await mt.digest(this.bytes);return e}},Oe=class{constructor(e,r){this._key=yr(e,he),this._publicKey=yr(r,dr)}async sign(e){return await H0(this._key,e)}get public(){return new zr(this._publicKey)}marshal(){return this._key}get bytes(){return $t.encode({Type:rt.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Dt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await mt.digest(this.bytes);return e}async id(){let e=await me.digest(this.public.bytes);return Bt.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return await hr(this.bytes,e);throw(0,ya.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function jl(t){if(t.length>he){t=yr(t,he+dr);let n=t.subarray(0,he),i=t.subarray(he,t.length);return new Oe(n,i)}t=yr(t,he);let e=t.subarray(0,he),r=t.subarray(dr);return new Oe(e,r)}function tp(t){return t=yr(t,dr),new zr(t)}async function ep(){let{privateKey:t,publicKey:e}=await q0();return new Oe(t,e)}async function Z0(t){let{privateKey:e,publicKey:r}=await z0(t);return new Oe(e,r)}function yr(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw(0,ya.default)(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}var va={};vt(va,{Secp256k1PrivateKey:()=>Gr,Secp256k1PublicKey:()=>Hr,generateKeyPair:()=>ap,unmarshalSecp256k1PrivateKey:()=>np,unmarshalSecp256k1PublicKey:()=>ip});var tf=Z(Ut(),1);var gr=Z(Ut(),1);function Y0(){return Gt.randomPrivateKey()}async function $0(t,e){let{digest:r}=await mt.digest(e);try{return await b0(r,t)}catch(n){throw(0,gr.default)(n,"ERR_INVALID_INPUT")}}async function Q0(t,e,r){try{let{digest:n}=await mt.digest(r);return w0(e,n,t)}catch(n){throw(0,gr.default)(n,"ERR_INVALID_INPUT")}}function X0(t){return Q.fromHex(t).toRawBytes(!0)}function J0(t){try{ea(t,!0)}catch(e){throw(0,gr.default)(e,"ERR_INVALID_PRIVATE_KEY")}}function xa(t){try{Q.fromHex(t)}catch(e){throw(0,gr.default)(e,"ERR_INVALID_PUBLIC_KEY")}}function j0(t){try{return ea(t,!0)}catch(e){throw(0,gr.default)(e,"ERR_INVALID_PRIVATE_KEY")}}var Hr=class{constructor(e){xa(e),this._key=e}async verify(e,r){return await Q0(this._key,r,e)}marshal(){return X0(this._key)}get bytes(){return Yt.encode({Type:rt.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Dt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await mt.digest(this.bytes);return e}},Gr=class{constructor(e,r){this._key=e,this._publicKey=r??j0(e),J0(this._key),xa(this._publicKey)}async sign(e){return await $0(this._key,e)}get public(){return new Hr(this._publicKey)}marshal(){return this._key}get bytes(){return $t.encode({Type:rt.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Dt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await mt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return Rt(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return await hr(this.bytes,e);throw(0,tf.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function np(t){return new Gr(t)}function ip(t){return new Hr(t)}async function ap(){let t=await Y0();return new Gr(t)}var Ae={rsa:sa,ed25519:ga,secp256k1:va};function ma(t){let e=Object.keys(Ae).join(" / ");return(0,ef.default)(new Error(`invalid or unsupported key type ${t}. Must be ${e}`),"ERR_UNSUPPORTED_KEY_TYPE")}function ba(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return Ae[t];throw ma(t)}async function Kn(t,e){return await ba(t).generateKeyPair(e??2048)}function rf(t){let e=Yt.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case rt.RSA:return Ae.rsa.unmarshalRsaPublicKey(r);case rt.Ed25519:return Ae.ed25519.unmarshalEd25519PublicKey(r);case rt.Secp256k1:return Ae.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw ma(e.Type??"RSA")}}function wa(t,e){return e=(e??"rsa").toLowerCase(),ba(e),t.bytes}async function nf(t){let e=$t.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case rt.RSA:return await Ae.rsa.unmarshalRsaPrivateKey(r);case rt.Ed25519:return Ae.ed25519.unmarshalEd25519PrivateKey(r);case rt.Secp256k1:return Ae.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw ma(e.Type??"RSA")}}function af(t,e){return e=(e??"rsa").toLowerCase(),ba(e),t.bytes}var op=Z(Ut(),1);var sf=Symbol.for("@libp2p/peer-id");var fp=Symbol.for("nodejs.util.inspect.custom"),of=Object.values(nr).map(t=>t.decoder).reduce((t,e)=>t.or(e),nr.identity.decoder),ff=114,Sa=36,Ea=37,Wr=class{constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[sf](){return!0}toString(){return this.string==null&&(this.string=Bt.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return st.createV1(ff,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Dt(this.multihash.bytes,e);if(typeof e=="string")return cp(e).equals(this);if(e?.multihash?.bytes!=null)return Dt(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[fp](){return`PeerId(${this.toString()})`}},xr=class extends Wr{constructor(e){super({...e,type:"RSA"}),this.type="RSA",this.publicKey=e.publicKey}},vr=class extends Wr{constructor(e){super({...e,type:"Ed25519"}),this.type="Ed25519",this.publicKey=e.multihash.digest}},mr=class extends Wr{constructor(e){super({...e,type:"secp256k1"}),this.type="secp256k1",this.publicKey=e.multihash.digest}};function cp(t,e){if(e=e??of,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=Rr(Bt.decode(`z${t}`));return t.startsWith("12D")?new vr({multihash:r}):t.startsWith("16U")?new mr({multihash:r}):new xr({multihash:r})}return Ba(of.decode(t))}function Ba(t){try{let e=Rr(t);if(e.code===me.code){if(e.digest.length===Sa)return new vr({multihash:e});if(e.digest.length===Ea)return new mr({multihash:e})}if(e.code===mt.code)return new xr({multihash:e})}catch{return up(st.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function up(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==ff)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===mt.code)return new xr({multihash:t.multihash});if(e.code===me.code){if(e.digest.length===Sa)return new vr({multihash:t.multihash});if(e.digest.length===Ea)return new mr({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function Aa(t,e){return t.length===Sa?new vr({multihash:re(me.code,t),privateKey:e}):t.length===Ea?new mr({multihash:re(me.code,t),privateKey:e}):new xr({multihash:await mt.digest(t),publicKey:t,privateKey:e})}var Zr;(function(t){let e;t.codec=()=>(e==null&&(e=Ge((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),(i.writeDefaults===!0||r.id!=null&&r.id.byteLength>0)&&(n.uint32(10),n.bytes(r.id)),r.pubKey!=null&&(n.uint32(18),n.bytes(r.pubKey)),r.privKey!=null&&(n.uint32(26),n.bytes(r.privKey)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={id:new Uint8Array(0)},a=n==null?r.len:r.pos+n;for(;r.pos<a;){let s=r.uint32();switch(s>>>3){case 1:i.id=r.bytes();break;case 2:i.pubKey=r.bytes();break;case 3:i.privKey=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>ze(r,t.codec()),t.decode=r=>qe(r,t.codec())})(Zr||(Zr={}));var hp=async()=>{let t=await Kn("Ed25519"),e=await Yr(t);if(e.type==="Ed25519")return e;throw new Error(`Generated unexpected PeerId type "${e.type}"`)},lp=async()=>{let t=await Kn("secp256k1"),e=await Yr(t);if(e.type==="secp256k1")return e;throw new Error(`Generated unexpected PeerId type "${e.type}"`)},pp=async t=>{let e=await Kn("RSA",t?.bits??2048),r=await Yr(e);if(r.type==="RSA")return r;throw new Error(`Generated unexpected PeerId type "${r.type}"`)};async function cf(t){return await Aa(wa(t))}async function Yr(t){return await Aa(wa(t.public),af(t))}function dp(t,e){return Zr.encode({id:t.multihash.bytes,pubKey:t.publicKey,privKey:e===!0||t.privateKey==null?void 0:t.privateKey})}async function yp(t){let{id:e,privKey:r,pubKey:n}=Zr.decode(t);return await uf(e,r,n)}async function gp(t){return await uf(bt(t.id,"base58btc"),t.privKey!=null?bt(t.privKey,"base64pad"):void 0,t.pubKey!=null?bt(t.pubKey,"base64pad"):void 0)}async function uf(t,e,r){if(e!=null){let n=await nf(e);return await Yr(n)}else if(r!=null){let n=await rf(r);return await cf(n)}return Ba(t)}return gf(xp);})();
return Libp2PPeerIdFactory}));
